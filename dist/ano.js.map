{
  "version": 3,
  "sources": ["../src/index.js", "../src/core/config.js", "../src/core/events.js", "../src/core/id.js", "../src/core/store.js", "../src/anchoring/text-quote.js", "../src/anchoring/text-position.js", "../src/anchoring/selector.js", "../src/anchoring/resolver.js", "../src/annotations/highlight.js", "../src/annotations/pin.js", "../src/ui/styles.js", "../src/annotations/drawing.js", "../src/annotations/recording.js", "../src/annotations/session.js", "../src/ui/components.js", "../src/ui/toolbar.js", "../src/ui/popover.js", "../src/ui/end-dialog.js", "../src/shortcuts.js", "../src/io/export.js", "../src/io/import.js", "../src/io/share.js", "../src/api.js"],
  "sourcesContent": ["import * as api from './api.js';\n\nlet currentApi = null;\n\nfunction init(options = {}) {\n  currentApi = api.init(options);\n  return currentApi;\n}\n\nfunction clear() {\n  if (currentApi) currentApi.clear();\n}\n\nfunction destroy() {\n  api.destroy();\n  currentApi = null;\n}\n\nfunction getAll() {\n  return currentApi ? currentApi.getAll() : [];\n}\n\nfunction toJSON() {\n  return currentApi ? currentApi.toJSON() : null;\n}\n\nfunction exportJSON() {\n  if (currentApi) return currentApi.export();\n}\n\nfunction importFile() {\n  if (currentApi) return currentApi.importFile();\n}\n\nfunction importJSON(data) {\n  if (currentApi) return currentApi.import(data);\n}\n\nfunction setMode(mode) {\n  if (currentApi) currentApi.setMode(mode);\n}\n\nfunction startSession() {\n  if (currentApi) currentApi.startSession();\n}\n\nfunction endSession() {\n  if (currentApi) currentApi.endSession();\n}\n\n// Use object export so we can use reserved words as property names\n// esbuild IIFE with globalName will expose this as window.Ano\nexport {\n  init,\n  clear,\n  destroy,\n  getAll,\n  toJSON,\n  exportJSON as export,\n  importFile,\n  importJSON as import,\n  setMode,\n  startSession,\n  endSession,\n};\n", "const DEFAULTS = {\n  theme: 'light',\n  mode: 'navigate',\n  highlightColor: '#fde047',\n  pinColor: '#3b82f6',\n  drawColor: '#ef4444',\n  drawWidth: 3,\n  shortcuts: true,\n  recordMaxDuration: 30000,\n  recordFrameRate: 30,\n  sessionMaxDuration: 300000,\n  videoRecording: false,\n};\n\nexport function createConfig(overrides = {}) {\n  return { ...DEFAULTS, ...overrides };\n}\n", "export function createEventBus() {\n  const listeners = new Map();\n\n  return {\n    on(event, fn) {\n      if (!listeners.has(event)) listeners.set(event, new Set());\n      listeners.get(event).add(fn);\n      return () => listeners.get(event)?.delete(fn);\n    },\n\n    off(event, fn) {\n      listeners.get(event)?.delete(fn);\n    },\n\n    emit(event, ...args) {\n      listeners.get(event)?.forEach((fn) => fn(...args));\n    },\n\n    clear() {\n      listeners.clear();\n    },\n  };\n}\n", "const ALPHABET = 'abcdefghijklmnopqrstuvwxyz0123456789';\nconst ID_LENGTH = 8;\n\nexport function nanoid() {\n  let id = '';\n  const bytes = crypto.getRandomValues(new Uint8Array(ID_LENGTH));\n  for (let i = 0; i < ID_LENGTH; i++) {\n    id += ALPHABET[bytes[i] % ALPHABET.length];\n  }\n  return id;\n}\n", "import { createEventBus } from './events.js';\nimport { nanoid } from './id.js';\n\nexport function createStore() {\n  const annotations = new Map();\n  const bus = createEventBus();\n  let pinCounter = 0;\n\n  function add(data) {\n    const id = data.id || nanoid();\n    const annotation = {\n      ...data,\n      id,\n      createdAt: data.createdAt || Date.now(),\n    };\n    if (annotation.type === 'pin' && annotation.index == null) {\n      pinCounter++;\n      annotation.index = pinCounter;\n    }\n    annotations.set(id, annotation);\n    bus.emit('add', annotation);\n    bus.emit('change', { type: 'add', annotation });\n    return annotation;\n  }\n\n  function update(id, changes) {\n    const existing = annotations.get(id);\n    if (!existing) return null;\n    const updated = { ...existing, ...changes, id };\n    annotations.set(id, updated);\n    bus.emit('update', updated);\n    bus.emit('change', { type: 'update', annotation: updated });\n    return updated;\n  }\n\n  function remove(id) {\n    const annotation = annotations.get(id);\n    if (!annotation) return false;\n    annotations.delete(id);\n    bus.emit('remove', annotation);\n    bus.emit('change', { type: 'remove', annotation });\n    return true;\n  }\n\n  function get(id) {\n    return annotations.get(id) || null;\n  }\n\n  function getAll() {\n    return Array.from(annotations.values());\n  }\n\n  function getByType(type) {\n    return getAll().filter((a) => a.type === type);\n  }\n\n  function clear() {\n    const all = getAll();\n    annotations.clear();\n    pinCounter = 0;\n    bus.emit('clear', all);\n    bus.emit('change', { type: 'clear', annotations: all });\n  }\n\n  function resetPinCounter() {\n    const pins = getByType('pin');\n    pinCounter = pins.length > 0 ? Math.max(...pins.map((p) => p.index)) : 0;\n  }\n\n  return {\n    add,\n    update,\n    remove,\n    get,\n    getAll,\n    getByType,\n    clear,\n    resetPinCounter,\n    on: bus.on,\n    off: bus.off,\n    emit: bus.emit,\n    destroy: bus.clear,\n  };\n}\n", "const CONTEXT_LENGTH = 32;\n\nexport function createTextQuoteSelector(range) {\n  const exact = range.toString();\n  if (!exact) return null;\n\n  const body = document.body;\n  const textContent = body.textContent || '';\n\n  // Find position of exact match in full text\n  const beforeRange = document.createRange();\n  beforeRange.setStart(body, 0);\n  beforeRange.setEnd(range.startContainer, range.startOffset);\n  const beforeText = beforeRange.toString();\n\n  const prefixStart = Math.max(0, beforeText.length - CONTEXT_LENGTH);\n  const prefix = beforeText.slice(prefixStart);\n\n  const afterRange = document.createRange();\n  afterRange.setStart(range.endContainer, range.endOffset);\n  afterRange.setEnd(body, body.childNodes.length);\n  const afterText = afterRange.toString();\n  const suffix = afterText.slice(0, CONTEXT_LENGTH);\n\n  return {\n    type: 'TextQuoteSelector',\n    exact,\n    prefix,\n    suffix,\n  };\n}\n\nexport function resolveTextQuoteSelector(selector) {\n  if (!selector || !selector.exact) return null;\n\n  const body = document.body;\n  const text = body.textContent || '';\n  const { exact, prefix, suffix } = selector;\n\n  // Try exact + prefix/suffix match first\n  const candidates = [];\n  let searchFrom = 0;\n  while (true) {\n    const idx = text.indexOf(exact, searchFrom);\n    if (idx === -1) break;\n    candidates.push(idx);\n    searchFrom = idx + 1;\n  }\n\n  if (candidates.length === 0) return null;\n\n  // Score candidates by context match\n  let bestIdx = candidates[0];\n  let bestScore = -1;\n\n  for (const idx of candidates) {\n    let score = 0;\n    if (prefix) {\n      const beforeSlice = text.slice(Math.max(0, idx - prefix.length), idx);\n      if (beforeSlice === prefix) score += 2;\n      else if (beforeSlice.endsWith(prefix.slice(-8))) score += 1;\n    }\n    if (suffix) {\n      const afterSlice = text.slice(idx + exact.length, idx + exact.length + suffix.length);\n      if (afterSlice === suffix) score += 2;\n      else if (afterSlice.startsWith(suffix.slice(0, 8))) score += 1;\n    }\n    if (score > bestScore) {\n      bestScore = score;\n      bestIdx = idx;\n    }\n  }\n\n  return textPositionToRange(bestIdx, bestIdx + exact.length);\n}\n\nfunction textPositionToRange(start, end) {\n  const walker = document.createTreeWalker(document.body, NodeFilter.SHOW_TEXT);\n  let pos = 0;\n  let startNode = null, startOffset = 0;\n  let endNode = null, endOffset = 0;\n\n  while (walker.nextNode()) {\n    const node = walker.currentNode;\n    const len = node.textContent.length;\n\n    if (!startNode && pos + len > start) {\n      startNode = node;\n      startOffset = start - pos;\n    }\n    if (pos + len >= end) {\n      endNode = node;\n      endOffset = end - pos;\n      break;\n    }\n    pos += len;\n  }\n\n  if (!startNode || !endNode) return null;\n\n  try {\n    const range = document.createRange();\n    range.setStart(startNode, startOffset);\n    range.setEnd(endNode, endOffset);\n    return range;\n  } catch {\n    return null;\n  }\n}\n", "export function createTextPositionSelector(range) {\n  const body = document.body;\n  const beforeRange = document.createRange();\n  beforeRange.setStart(body, 0);\n  beforeRange.setEnd(range.startContainer, range.startOffset);\n  const start = beforeRange.toString().length;\n  const end = start + range.toString().length;\n\n  return {\n    type: 'TextPositionSelector',\n    start,\n    end,\n  };\n}\n\nexport function resolveTextPositionSelector(selector) {\n  if (!selector || selector.start == null || selector.end == null) return null;\n\n  const { start, end } = selector;\n  const walker = document.createTreeWalker(document.body, NodeFilter.SHOW_TEXT);\n  let pos = 0;\n  let startNode = null, startOffset = 0;\n  let endNode = null, endOffset = 0;\n\n  while (walker.nextNode()) {\n    const node = walker.currentNode;\n    const len = node.textContent.length;\n\n    if (!startNode && pos + len > start) {\n      startNode = node;\n      startOffset = start - pos;\n    }\n    if (pos + len >= end) {\n      endNode = node;\n      endOffset = end - pos;\n      break;\n    }\n    pos += len;\n  }\n\n  if (!startNode || !endNode) return null;\n\n  try {\n    const range = document.createRange();\n    range.setStart(startNode, startOffset);\n    range.setEnd(endNode, endOffset);\n    return range;\n  } catch {\n    return null;\n  }\n}\n", "export function generateCSSSelector(element) {\n  if (element.id) {\n    const sel = `#${CSS.escape(element.id)}`;\n    if (isUnique(sel)) return sel;\n  }\n\n  const path = [];\n  let current = element;\n\n  while (current && current !== document.body && current !== document.documentElement) {\n    let seg = current.tagName.toLowerCase();\n\n    if (current.id) {\n      seg = `#${CSS.escape(current.id)}`;\n      path.unshift(seg);\n      break;\n    }\n\n    const parent = current.parentElement;\n    if (parent) {\n      const siblings = Array.from(parent.children).filter(\n        (c) => c.tagName === current.tagName\n      );\n      if (siblings.length > 1) {\n        const index = siblings.indexOf(current) + 1;\n        seg += `:nth-of-type(${index})`;\n      }\n    }\n\n    path.unshift(seg);\n    current = parent;\n  }\n\n  if (path[0] && !path[0].startsWith('#')) {\n    path.unshift('body');\n  }\n\n  const selector = path.join(' > ');\n\n  if (isUnique(selector)) return selector;\n  return selector;\n}\n\nexport function getTargetMeta(element) {\n  return {\n    tagName: element.tagName,\n    textContent: (element.textContent || '').trim().slice(0, 100),\n    className: element.className || '',\n  };\n}\n\nexport function resolveTarget(selector, meta) {\n  // Try CSS selector first\n  try {\n    const el = document.querySelector(selector);\n    if (el) return el;\n  } catch { /* invalid selector */ }\n\n  // Fallback: find by tag + text content\n  if (meta) {\n    const candidates = document.querySelectorAll(meta.tagName?.toLowerCase() || '*');\n    for (const el of candidates) {\n      const text = (el.textContent || '').trim().slice(0, 100);\n      if (text === meta.textContent) return el;\n    }\n  }\n\n  return null;\n}\n\nfunction isUnique(selector) {\n  try {\n    return document.querySelectorAll(selector).length === 1;\n  } catch {\n    return false;\n  }\n}\n", "import { resolveTextQuoteSelector } from './text-quote.js';\nimport { resolveTextPositionSelector } from './text-position.js';\nimport { resolveTarget } from './selector.js';\n\nexport function resolveHighlight(selectors) {\n  if (!selectors) return null;\n\n  // Try TextPosition first (fast, exact)\n  if (selectors.textPosition) {\n    const range = resolveTextPositionSelector(selectors.textPosition);\n    if (range && validateRange(range, selectors.textQuote?.exact)) return range;\n  }\n\n  // Fall back to TextQuote (handles DOM changes)\n  if (selectors.textQuote) {\n    const range = resolveTextQuoteSelector(selectors.textQuote);\n    if (range) return range;\n  }\n\n  return null;\n}\n\nexport function resolvePin(annotation) {\n  return resolveTarget(annotation.targetSelector, annotation.targetMeta);\n}\n\nfunction validateRange(range, expectedText) {\n  if (!expectedText) return true;\n  const actual = range.toString();\n  return actual === expectedText;\n}\n", "import { createTextQuoteSelector } from '../anchoring/text-quote.js';\nimport { createTextPositionSelector } from '../anchoring/text-position.js';\nimport { resolveHighlight } from '../anchoring/resolver.js';\nimport { generateCSSSelector } from '../anchoring/selector.js';\n\nexport function createHighlightManager(ctx) {\n  const { store, config } = ctx;\n  let active = false;\n  const markElements = new Map(); // annotationId \u2192 [mark elements]\n\n  function enable() {\n    if (active) return;\n    active = true;\n    document.addEventListener('mouseup', onMouseUp, true);\n  }\n\n  function disable() {\n    active = false;\n    document.removeEventListener('mouseup', onMouseUp, true);\n  }\n\n  function onMouseUp(e) {\n    // Don't capture if clicking inside Ano UI\n    if (isAnoElement(e.target)) return;\n\n    const selection = window.getSelection();\n    if (!selection || selection.isCollapsed || !selection.rangeCount) return;\n\n    const range = selection.getRangeAt(0);\n    const text = range.toString().trim();\n    if (!text) return;\n\n    // Generate selectors before modifying DOM\n    const selectors = {\n      textQuote: createTextQuoteSelector(range),\n      textPosition: createTextPositionSelector(range),\n    };\n\n    // Capture context before DOM modification\n    const context = captureHighlightContext(range, text);\n\n    // Wrap the range\n    const marks = wrapRange(range);\n    if (marks.length === 0) return;\n\n    // Create annotation\n    const annotation = store.add({\n      type: 'highlight',\n      text,\n      comment: '',\n      selectors,\n      context,\n      color: config.highlightColor,\n    });\n\n    // Store mark element references\n    markElements.set(annotation.id, marks);\n    marks.forEach((mark) => {\n      mark.dataset.anoId = annotation.id;\n    });\n\n    selection.removeAllRanges();\n\n    // Show popover for comment\n    ctx.events.emit('highlight:created', annotation);\n  }\n\n  function wrapRange(range) {\n    const marks = [];\n\n    // Get all text nodes in the range\n    const textNodes = getTextNodesInRange(range);\n    if (textNodes.length === 0) return marks;\n\n    for (let i = 0; i < textNodes.length; i++) {\n      const node = textNodes[i];\n      let startOffset = 0;\n      let endOffset = node.textContent.length;\n\n      if (i === 0) startOffset = (node === range.startContainer) ? range.startOffset : 0;\n      if (i === textNodes.length - 1) endOffset = (node === range.endContainer) ? range.endOffset : node.textContent.length;\n\n      if (startOffset === endOffset) continue;\n\n      // Split text node if needed\n      let targetNode = node;\n      if (startOffset > 0) {\n        targetNode = node.splitText(startOffset);\n        endOffset -= startOffset;\n      }\n      if (endOffset < targetNode.textContent.length) {\n        targetNode.splitText(endOffset);\n      }\n\n      const mark = document.createElement('mark');\n      mark.className = 'ano-highlight';\n      targetNode.parentNode.insertBefore(mark, targetNode);\n      mark.appendChild(targetNode);\n      marks.push(mark);\n    }\n\n    return marks;\n  }\n\n  function getTextNodesInRange(range) {\n    const nodes = [];\n    const walker = document.createTreeWalker(\n      range.commonAncestorContainer.nodeType === Node.TEXT_NODE\n        ? range.commonAncestorContainer.parentNode\n        : range.commonAncestorContainer,\n      NodeFilter.SHOW_TEXT,\n    );\n\n    let started = false;\n    while (walker.nextNode()) {\n      const node = walker.currentNode;\n\n      if (node === range.startContainer || (range.startContainer.nodeType !== Node.TEXT_NODE && range.startContainer.contains(node))) {\n        started = true;\n      }\n\n      if (started && !isAnoElement(node.parentNode)) {\n        nodes.push(node);\n      }\n\n      if (node === range.endContainer || (range.endContainer.nodeType !== Node.TEXT_NODE && range.endContainer.contains(node))) {\n        break;\n      }\n    }\n\n    return nodes;\n  }\n\n  function applyHighlight(annotation) {\n    if (markElements.has(annotation.id)) return true; // Already rendered\n\n    const range = resolveHighlight(annotation.selectors);\n    if (!range) return false;\n\n    const marks = wrapRange(range);\n    if (marks.length === 0) return false;\n\n    markElements.set(annotation.id, marks);\n    marks.forEach((mark) => {\n      mark.dataset.anoId = annotation.id;\n      if (annotation.color) {\n        mark.style.setProperty('--ano-hl-color', annotation.color);\n      }\n    });\n\n    return true;\n  }\n\n  function removeHighlight(id) {\n    const marks = markElements.get(id);\n    if (!marks) return;\n\n    for (const mark of marks) {\n      const parent = mark.parentNode;\n      if (!parent) continue;\n      while (mark.firstChild) {\n        parent.insertBefore(mark.firstChild, mark);\n      }\n      parent.removeChild(mark);\n      parent.normalize();\n    }\n\n    markElements.delete(id);\n  }\n\n  function removeAll() {\n    for (const id of [...markElements.keys()]) {\n      removeHighlight(id);\n    }\n  }\n\n  function getMarksForAnnotation(id) {\n    return markElements.get(id) || [];\n  }\n\n  function captureHighlightContext(range, text) {\n    // Find the nearest meaningful container element\n    let container = range.commonAncestorContainer;\n    if (container.nodeType === Node.TEXT_NODE) container = container.parentElement;\n\n    // Walk up to find a semantically meaningful element (not just a span/div wrapper)\n    const semantic = findSemanticParent(container);\n\n    const containerInfo = {\n      selector: generateCSSSelector(semantic),\n      tagName: semantic.tagName,\n      text: truncate(getDirectText(semantic), 200),\n    };\n\n    // Build ancestor path for page-structure context: e.g. [\"main\", \"article\", \"section\", \"p\"]\n    const path = [];\n    let walk = semantic;\n    while (walk && walk !== document.body) {\n      const tag = walk.tagName.toLowerCase();\n      const id = walk.id ? `#${walk.id}` : '';\n      const landmark = walk.getAttribute('role') || '';\n      let label = tag + id;\n      if (landmark) label += `[role=${landmark}]`;\n      path.unshift(label);\n      walk = walk.parentElement;\n    }\n\n    // Grab surrounding text for context window\n    const fullText = semantic.textContent || '';\n    const idx = fullText.indexOf(text);\n    let surroundingText = '';\n    if (idx !== -1) {\n      const before = fullText.slice(Math.max(0, idx - 80), idx).trim();\n      const after = fullText.slice(idx + text.length, idx + text.length + 80).trim();\n      surroundingText = (before ? '...' + before + ' ' : '') +\n        '[' + truncate(text, 100) + ']' +\n        (after ? ' ' + after + '...' : '');\n    }\n\n    return {\n      element: containerInfo,\n      pagePath: path,\n      surroundingText,\n    };\n  }\n\n  function findSemanticParent(el) {\n    const semanticTags = new Set([\n      'P', 'H1', 'H2', 'H3', 'H4', 'H5', 'H6',\n      'LI', 'TD', 'TH', 'BLOCKQUOTE', 'FIGCAPTION', 'CAPTION',\n      'LABEL', 'A', 'BUTTON', 'ARTICLE', 'SECTION', 'NAV',\n      'HEADER', 'FOOTER', 'MAIN', 'ASIDE', 'DETAILS', 'SUMMARY',\n    ]);\n    let node = el;\n    while (node && node !== document.body) {\n      if (semanticTags.has(node.tagName) || node.id || node.getAttribute('role')) {\n        return node;\n      }\n      node = node.parentElement;\n    }\n    return el; // fall back to original\n  }\n\n  function getDirectText(el) {\n    // Get text without going too deep \u2014 avoids grabbing entire section text\n    if (el.children.length === 0) return (el.textContent || '').trim();\n\n    let text = '';\n    for (const child of el.childNodes) {\n      if (child.nodeType === Node.TEXT_NODE) {\n        text += child.textContent;\n      } else if (child.nodeType === Node.ELEMENT_NODE) {\n        // Include inline elements, skip block-level children\n        const display = getComputedStyle(child).display;\n        if (display === 'inline' || display === 'inline-block') {\n          text += child.textContent;\n        }\n      }\n    }\n    return text.trim() || (el.textContent || '').trim().slice(0, 200);\n  }\n\n  function truncate(str, max) {\n    return str.length > max ? str.slice(0, max) + '...' : str;\n  }\n\n  function destroy() {\n    disable();\n    removeAll();\n  }\n\n  return {\n    enable,\n    disable,\n    applyHighlight,\n    removeHighlight,\n    removeAll,\n    getMarksForAnnotation,\n    destroy,\n  };\n}\n\nfunction isAnoElement(el) {\n  if (!el) return false;\n  if (el.closest && el.closest('[data-ano]')) return true;\n  // Check shadow DOM hosts\n  let node = el;\n  while (node) {\n    if (node.host && node.host.dataset && node.host.dataset.ano !== undefined) return true;\n    if (node.dataset && node.dataset.ano !== undefined) return true;\n    node = node.parentNode;\n  }\n  return false;\n}\n", "import { generateCSSSelector, getTargetMeta, resolveTarget } from '../anchoring/selector.js';\n\nexport function createPinManager(ctx) {\n  const { store, config } = ctx;\n  let active = false;\n  const pinElements = new Map(); // annotationId \u2192 { marker, target }\n  let hoverOutline = null;\n  let overlay = null;\n\n  function enable() {\n    if (active) return;\n    active = true;\n    createOverlay();\n    document.addEventListener('mousemove', onMouseMove, true);\n  }\n\n  function disable() {\n    active = false;\n    removeOverlay();\n    document.removeEventListener('mousemove', onMouseMove, true);\n  }\n\n  function createOverlay() {\n    overlay = document.createElement('div');\n    overlay.className = 'ano-pin-overlay active';\n    overlay.dataset.ano = '';\n    overlay.addEventListener('click', onOverlayClick, true);\n    overlay.addEventListener('mousemove', onOverlayMouseMove);\n    document.body.appendChild(overlay);\n\n    hoverOutline = document.createElement('div');\n    hoverOutline.className = 'ano-pin-hover-outline';\n    hoverOutline.dataset.ano = '';\n    document.body.appendChild(hoverOutline);\n  }\n\n  function removeOverlay() {\n    if (overlay) {\n      overlay.removeEventListener('click', onOverlayClick, true);\n      overlay.removeEventListener('mousemove', onOverlayMouseMove);\n      overlay.remove();\n      overlay = null;\n    }\n    if (hoverOutline) {\n      hoverOutline.remove();\n      hoverOutline = null;\n    }\n  }\n\n  function onOverlayMouseMove(e) {\n    // Temporarily hide overlay to hit-test below\n    overlay.style.pointerEvents = 'none';\n    const target = document.elementFromPoint(e.clientX, e.clientY);\n    overlay.style.pointerEvents = 'auto';\n\n    if (target && target.tagName === 'IFRAME') {\n      // Forward hover into child frame \u2014 child's own overlay shows the highlight\n      const rect = target.getBoundingClientRect();\n      try {\n        target.contentWindow?.postMessage({\n          source: 'ano-parent', type: 'pin:hover',\n          x: e.clientX - rect.left, y: e.clientY - rect.top,\n        }, '*');\n      } catch {}\n      hoverOutline.style.display = 'none';\n      return;\n    }\n\n    if (target && target !== document.body && target !== document.documentElement && !isAnoElement(target)) {\n      const rect = target.getBoundingClientRect();\n      hoverOutline.style.display = 'block';\n      hoverOutline.style.left = `${rect.left + window.scrollX}px`;\n      hoverOutline.style.top = `${rect.top + window.scrollY}px`;\n      hoverOutline.style.width = `${rect.width}px`;\n      hoverOutline.style.height = `${rect.height}px`;\n    } else {\n      hoverOutline.style.display = 'none';\n    }\n  }\n\n  function onMouseMove() {\n    // Keep hover outline tracking when not using overlay approach\n  }\n\n  function onOverlayClick(e) {\n    e.preventDefault();\n    e.stopPropagation();\n\n    overlay.style.pointerEvents = 'none';\n    const target = document.elementFromPoint(e.clientX, e.clientY);\n    overlay.style.pointerEvents = 'auto';\n\n    if (target && target.tagName === 'IFRAME') {\n      // Forward click into child frame\n      const rect = target.getBoundingClientRect();\n      try {\n        target.contentWindow?.postMessage({\n          source: 'ano-parent', type: 'pin:click',\n          x: e.clientX - rect.left, y: e.clientY - rect.top,\n        }, '*');\n      } catch {}\n      return;\n    }\n\n    if (!target || target === document.body || target === document.documentElement || isAnoElement(target)) {\n      return;\n    }\n\n    const targetSelector = generateCSSSelector(target);\n    const targetMeta = getTargetMeta(target);\n    const context = capturePinContext(target);\n\n    const annotation = store.add({\n      type: 'pin',\n      comment: '',\n      targetSelector,\n      targetMeta,\n      context,\n    });\n\n    createPinMarker(annotation, target);\n    ctx.events.emit('pin:created', annotation);\n  }\n\n  function createPinMarker(annotation, target) {\n    const marker = document.createElement('div');\n    marker.className = 'ano-pin-marker';\n    marker.dataset.ano = '';\n    marker.dataset.anoId = annotation.id;\n    marker.textContent = annotation.index;\n    marker.style.setProperty('--ano-pin-color', config.pinColor);\n    document.body.appendChild(marker);\n\n    positionMarker(marker, target);\n    pinElements.set(annotation.id, { marker, target });\n\n    marker.addEventListener('click', (e) => {\n      e.stopPropagation();\n      ctx.events.emit('pin:click', annotation);\n    });\n  }\n\n  function positionMarker(marker, target) {\n    const rect = target.getBoundingClientRect();\n    marker.style.left = `${rect.left + window.scrollX - 12}px`;\n    marker.style.top = `${rect.top + window.scrollY - 12}px`;\n  }\n\n  function repositionAll() {\n    for (const [id, { marker, target }] of pinElements) {\n      if (document.body.contains(target)) {\n        positionMarker(marker, target);\n      }\n    }\n  }\n\n  function applyPin(annotation) {\n    if (pinElements.has(annotation.id)) return true;\n\n    const target = resolveTarget(annotation.targetSelector, annotation.targetMeta);\n    if (!target) return false;\n\n    createPinMarker(annotation, target);\n    return true;\n  }\n\n  function removePin(id) {\n    const entry = pinElements.get(id);\n    if (!entry) return;\n    entry.marker.remove();\n    pinElements.delete(id);\n  }\n\n  function removeAll() {\n    for (const [id] of [...pinElements]) {\n      removePin(id);\n    }\n  }\n\n  // Called in child frames when parent forwards a hover position\n  function hoverAt(x, y) {\n    if (!active || !hoverOutline) return;\n    const target = document.elementFromPoint(x, y);\n    if (target && target !== document.body && target !== document.documentElement && !isAnoElement(target)) {\n      const rect = target.getBoundingClientRect();\n      hoverOutline.style.display = 'block';\n      hoverOutline.style.left = `${rect.left + window.scrollX}px`;\n      hoverOutline.style.top = `${rect.top + window.scrollY}px`;\n      hoverOutline.style.width = `${rect.width}px`;\n      hoverOutline.style.height = `${rect.height}px`;\n    } else {\n      hoverOutline.style.display = 'none';\n    }\n  }\n\n  // Called in child frames when parent forwards a click position\n  function clickAt(x, y) {\n    if (!active) return;\n    const target = document.elementFromPoint(x, y);\n    if (!target || target === document.body || target === document.documentElement || isAnoElement(target)) return;\n\n    const targetSelector = generateCSSSelector(target);\n    const targetMeta = getTargetMeta(target);\n    const context = capturePinContext(target);\n    const annotation = store.add({ type: 'pin', comment: '', targetSelector, targetMeta, context });\n    createPinMarker(annotation, target);\n    ctx.events.emit('pin:created', annotation);\n  }\n\n  function scrollToPin(id) {\n    const entry = pinElements.get(id);\n    if (!entry) return;\n    entry.target.scrollIntoView({ behavior: 'smooth', block: 'center' });\n  }\n\n  function capturePinContext(target) {\n    const tag = target.tagName.toLowerCase();\n\n    // Collect useful attributes\n    const attrs = {};\n    const useful = ['href', 'src', 'action', 'type', 'name', 'placeholder',\n      'value', 'alt', 'title', 'role', 'aria-label', 'aria-describedby',\n      'data-testid', 'for', 'method'];\n    for (const name of useful) {\n      const val = target.getAttribute(name);\n      if (val) attrs[name] = val.length > 120 ? val.slice(0, 120) + '...' : val;\n    }\n\n    // Visible text content (direct, not deep)\n    const visibleText = getVisibleText(target);\n\n    // Parent chain for structural context: [\"body\", \"main\", \"form\", \"div.form-group\"]\n    const path = [];\n    let walk = target;\n    while (walk && walk !== document.body) {\n      let label = walk.tagName.toLowerCase();\n      if (walk.id) label += `#${walk.id}`;\n      else if (walk.className && typeof walk.className === 'string') {\n        const cls = walk.className.trim().split(/\\s+/).slice(0, 2).join('.');\n        if (cls) label += `.${cls}`;\n      }\n      if (walk.getAttribute('role')) label += `[role=${walk.getAttribute('role')}]`;\n      path.unshift(label);\n      walk = walk.parentElement;\n    }\n\n    // Sibling context \u2014 what's next to this element\n    const siblings = [];\n    const parent = target.parentElement;\n    if (parent) {\n      for (const child of parent.children) {\n        if (child === target) continue;\n        const sib = child.tagName.toLowerCase();\n        const sibText = truncate((child.textContent || '').trim(), 60);\n        if (sibText) siblings.push(`${sib}(\"${sibText}\")`);\n        if (siblings.length >= 4) break;\n      }\n    }\n\n    // Build description\n    let desc = `${tag}`;\n    if (visibleText) desc += `(\"${truncate(visibleText, 80)}\")`;\n    if (attrs.type) desc += `[type=${attrs.type}]`;\n    if (attrs.href) desc += `[href=${truncate(attrs.href, 60)}]`;\n    if (attrs.role) desc += `[role=${attrs.role}]`;\n    const parentTag = parent ? parent.tagName.toLowerCase() : '';\n    if (parentTag) desc += ` inside ${parentTag}`;\n    if (parent?.id) desc += `#${parent.id}`;\n\n    return {\n      description: desc,\n      attributes: Object.keys(attrs).length > 0 ? attrs : undefined,\n      visibleText: visibleText || undefined,\n      pagePath: path,\n      siblings: siblings.length > 0 ? siblings : undefined,\n    };\n  }\n\n  function getVisibleText(el) {\n    // Prefer explicit labels\n    const aria = el.getAttribute('aria-label');\n    if (aria) return aria.trim();\n    const alt = el.getAttribute('alt');\n    if (alt) return alt.trim();\n    const title = el.getAttribute('title');\n    if (title) return title.trim();\n\n    // Direct text nodes only\n    let text = '';\n    for (const child of el.childNodes) {\n      if (child.nodeType === Node.TEXT_NODE) text += child.textContent;\n    }\n    text = text.trim();\n    if (text) return text;\n\n    return (el.textContent || '').trim().slice(0, 150);\n  }\n\n  function truncate(str, max) {\n    return str.length > max ? str.slice(0, max) + '...' : str;\n  }\n\n  function destroy() {\n    disable();\n    removeAll();\n  }\n\n  return {\n    enable,\n    disable,\n    applyPin,\n    removePin,\n    removeAll,\n    repositionAll,\n    scrollToPin,\n    hoverAt,\n    clickAt,\n    destroy,\n  };\n}\n\nfunction isAnoElement(el) {\n  if (!el) return false;\n  let node = el;\n  while (node) {\n    if (node.dataset && node.dataset.ano !== undefined) return true;\n    if (node.host && node.host.dataset && node.host.dataset.ano !== undefined) return true;\n    node = node.parentNode;\n  }\n  return false;\n}\n", "export const THEME = {\n  light: {\n    '--ano-bg': '#ffffff',\n    '--ano-bg-secondary': '#f8fafc',\n    '--ano-bg-hover': '#f1f5f9',\n    '--ano-border': '#e2e8f0',\n    '--ano-text': '#1e293b',\n    '--ano-text-secondary': '#64748b',\n    '--ano-accent': '#3b82f6',\n    '--ano-accent-hover': '#2563eb',\n    '--ano-highlight': '#fde047',\n    '--ano-pin': '#3b82f6',\n    '--ano-draw': '#ef4444',\n    '--ano-danger': '#ef4444',\n    '--ano-danger-hover': '#dc2626',\n    '--ano-shadow': '0 4px 24px rgba(0,0,0,0.12)',\n    '--ano-shadow-sm': '0 2px 8px rgba(0,0,0,0.08)',\n  },\n  dark: {\n    '--ano-bg': '#1e293b',\n    '--ano-bg-secondary': '#0f172a',\n    '--ano-bg-hover': '#334155',\n    '--ano-border': '#475569',\n    '--ano-text': '#f1f5f9',\n    '--ano-text-secondary': '#94a3b8',\n    '--ano-accent': '#60a5fa',\n    '--ano-accent-hover': '#3b82f6',\n    '--ano-highlight': '#fbbf24',\n    '--ano-pin': '#60a5fa',\n    '--ano-draw': '#f87171',\n    '--ano-danger': '#f87171',\n    '--ano-danger-hover': '#ef4444',\n    '--ano-shadow': '0 4px 24px rgba(0,0,0,0.4)',\n    '--ano-shadow-sm': '0 2px 8px rgba(0,0,0,0.3)',\n  },\n};\n\nexport const sidebarCSS = `\n  :host {\n    all: initial;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n    font-size: 14px;\n    color: var(--ano-text);\n  }\n  * { box-sizing: border-box; margin: 0; padding: 0; }\n  .ano-sidebar {\n    position: fixed;\n    top: 0;\n    right: 0;\n    width: var(--ano-sidebar-width, 320px);\n    height: 100vh;\n    background: var(--ano-bg);\n    border-left: 1px solid var(--ano-border);\n    box-shadow: var(--ano-shadow);\n    z-index: 2147483646;\n    display: flex;\n    flex-direction: column;\n    transform: translateX(100%);\n    transition: transform 0.25s ease;\n  }\n  .ano-sidebar.open {\n    transform: translateX(0);\n  }\n  .ano-sidebar-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 12px 16px;\n    border-bottom: 1px solid var(--ano-border);\n    background: var(--ano-bg-secondary);\n  }\n  .ano-sidebar-header h2 {\n    font-size: 15px;\n    font-weight: 600;\n    color: var(--ano-text);\n  }\n  .ano-sidebar-actions {\n    display: flex;\n    gap: 4px;\n  }\n  .ano-filter-bar {\n    display: flex;\n    gap: 4px;\n    padding: 8px 16px;\n    border-bottom: 1px solid var(--ano-border);\n    background: var(--ano-bg-secondary);\n  }\n  .ano-filter-btn {\n    padding: 4px 10px;\n    border-radius: 12px;\n    border: 1px solid var(--ano-border);\n    background: var(--ano-bg);\n    color: var(--ano-text-secondary);\n    font-size: 12px;\n    cursor: pointer;\n    transition: all 0.15s;\n  }\n  .ano-filter-btn:hover {\n    background: var(--ano-bg-hover);\n  }\n  .ano-filter-btn.active {\n    background: var(--ano-accent);\n    color: #fff;\n    border-color: var(--ano-accent);\n  }\n  .ano-list {\n    flex: 1;\n    overflow-y: auto;\n    padding: 8px;\n  }\n  .ano-list-empty {\n    padding: 32px 16px;\n    text-align: center;\n    color: var(--ano-text-secondary);\n    font-size: 13px;\n    line-height: 1.5;\n  }\n  .ano-card {\n    padding: 12px;\n    margin-bottom: 8px;\n    border-radius: 8px;\n    border: 1px solid var(--ano-border);\n    background: var(--ano-bg);\n    cursor: pointer;\n    transition: background 0.15s;\n  }\n  .ano-card:hover {\n    background: var(--ano-bg-hover);\n  }\n  .ano-card-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    margin-bottom: 6px;\n  }\n  .ano-card-type {\n    display: inline-flex;\n    align-items: center;\n    gap: 4px;\n    font-size: 11px;\n    font-weight: 600;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n  }\n  .ano-card-type.highlight { color: #ca8a04; }\n  .ano-card-type.pin { color: var(--ano-pin); }\n  .ano-card-type.drawing { color: var(--ano-draw); }\n  .ano-card-type.recording { color: #ef4444; }\n  .ano-card-type.session { color: #8b5cf6; }\n  .ano-card-meta {\n    font-size: 12px;\n    color: var(--ano-text-secondary);\n    margin-bottom: 4px;\n  }\n  .ano-card-delete {\n    opacity: 0;\n    transition: opacity 0.15s;\n  }\n  .ano-card:hover .ano-card-delete {\n    opacity: 1;\n  }\n  .ano-card-text {\n    font-size: 13px;\n    color: var(--ano-text);\n    margin-bottom: 4px;\n    line-height: 1.4;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    display: -webkit-box;\n    -webkit-line-clamp: 2;\n    -webkit-box-orient: vertical;\n  }\n  .ano-card-comment {\n    font-size: 12px;\n    color: var(--ano-text-secondary);\n    font-style: italic;\n    line-height: 1.4;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    display: -webkit-box;\n    -webkit-line-clamp: 2;\n    -webkit-box-orient: vertical;\n  }\n  .ano-card-time {\n    font-size: 11px;\n    color: var(--ano-text-secondary);\n    margin-top: 4px;\n  }\n  .ano-icon-btn {\n    display: inline-flex;\n    align-items: center;\n    justify-content: center;\n    width: 28px;\n    height: 28px;\n    border-radius: 6px;\n    border: none;\n    background: transparent;\n    color: var(--ano-text-secondary);\n    cursor: pointer;\n    transition: all 0.15s;\n    font-size: 16px;\n  }\n  .ano-icon-btn:hover {\n    background: var(--ano-bg-hover);\n    color: var(--ano-text);\n  }\n  .ano-icon-btn.danger:hover {\n    background: #fef2f2;\n    color: var(--ano-danger);\n  }\n  .ano-btn {\n    display: inline-flex;\n    align-items: center;\n    gap: 6px;\n    padding: 6px 12px;\n    border-radius: 6px;\n    border: 1px solid var(--ano-border);\n    background: var(--ano-bg);\n    color: var(--ano-text);\n    font-size: 13px;\n    cursor: pointer;\n    transition: all 0.15s;\n  }\n  .ano-btn:hover {\n    background: var(--ano-bg-hover);\n  }\n  .ano-btn.primary {\n    background: var(--ano-accent);\n    color: #fff;\n    border-color: var(--ano-accent);\n  }\n  .ano-btn.primary:hover {\n    background: var(--ano-accent-hover);\n  }\n  .ano-sidebar-footer {\n    display: flex;\n    gap: 8px;\n    padding: 12px 16px;\n    border-top: 1px solid var(--ano-border);\n    background: var(--ano-bg-secondary);\n  }\n  .ano-tab-toggle {\n    position: fixed;\n    right: 0;\n    top: 50%;\n    transform: translateY(-50%);\n    width: 28px;\n    height: 64px;\n    background: var(--ano-accent);\n    color: #fff;\n    border: none;\n    border-radius: 6px 0 0 6px;\n    cursor: pointer;\n    z-index: 2147483646;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    font-size: 14px;\n    box-shadow: var(--ano-shadow-sm);\n    transition: right 0.25s ease, background 0.15s;\n  }\n  .ano-tab-toggle:hover {\n    background: var(--ano-accent-hover);\n  }\n  .ano-tab-toggle.shifted {\n    right: var(--ano-sidebar-width, 320px);\n  }\n  .ano-btn:disabled {\n    opacity: 0.5;\n    cursor: default;\n    pointer-events: none;\n  }\n  .ano-toast {\n    position: absolute;\n    bottom: 60px;\n    left: 16px;\n    right: 16px;\n    padding: 10px 14px;\n    border-radius: 8px;\n    background: var(--ano-bg-secondary);\n    border: 1px solid var(--ano-border);\n    font-size: 13px;\n    opacity: 0;\n    transform: translateY(8px);\n    transition: all 0.2s;\n    pointer-events: none;\n    z-index: 1;\n  }\n  .ano-toast.visible { opacity: 1; transform: translateY(0); pointer-events: auto; }\n  .ano-toast.error { border-color: var(--ano-danger); }\n  .ano-toast a { color: var(--ano-accent); word-break: break-all; }\n`;\n\nexport const toolbarCSS = `\n  :host {\n    all: initial;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n  }\n  * { box-sizing: border-box; margin: 0; padding: 0; }\n  .ano-toolbar {\n    position: fixed;\n    top: 12px;\n    left: 50%;\n    transform: translateX(-50%);\n    display: flex;\n    gap: 2px;\n    padding: 4px;\n    background: var(--ano-bg);\n    border: 1px solid var(--ano-border);\n    border-radius: 10px;\n    box-shadow: var(--ano-shadow);\n    z-index: 2147483646;\n    user-select: none;\n  }\n  .ano-toolbar-btn {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 36px;\n    height: 36px;\n    border-radius: 8px;\n    border: none;\n    background: transparent;\n    color: var(--ano-text-secondary);\n    cursor: pointer;\n    transition: all 0.15s;\n    font-size: 18px;\n    position: relative;\n  }\n  .ano-toolbar-btn:hover {\n    background: var(--ano-bg-hover);\n    color: var(--ano-text);\n  }\n  .ano-toolbar-btn.active {\n    background: var(--ano-accent);\n    color: #fff;\n  }\n  .ano-toolbar-btn .tooltip {\n    position: absolute;\n    bottom: -30px;\n    left: 50%;\n    transform: translateX(-50%);\n    padding: 3px 8px;\n    background: var(--ano-text);\n    color: var(--ano-bg);\n    font-size: 11px;\n    border-radius: 4px;\n    white-space: nowrap;\n    opacity: 0;\n    pointer-events: none;\n    transition: opacity 0.15s;\n  }\n  .ano-toolbar-btn:hover .tooltip {\n    opacity: 1;\n  }\n  .ano-toolbar-divider {\n    width: 1px;\n    margin: 6px 3px;\n    background: var(--ano-border);\n    flex-shrink: 0;\n  }\n  .ano-start-session {\n    display: flex;\n    align-items: center;\n    gap: 6px;\n    padding: 6px 14px;\n    border-radius: 8px;\n    border: none;\n    background: var(--ano-accent);\n    color: #fff;\n    cursor: pointer;\n    transition: all 0.15s;\n    font-size: 13px;\n    font-weight: 600;\n    font-family: inherit;\n    white-space: nowrap;\n  }\n  .ano-start-session:hover {\n    background: var(--ano-accent-hover);\n  }\n  .ano-video-toggle {\n    display: flex;\n    align-items: center;\n    gap: 5px;\n    padding: 0 8px;\n    font-size: 12px;\n    color: var(--ano-text-secondary);\n    cursor: pointer;\n    user-select: none;\n    white-space: nowrap;\n  }\n  .ano-video-toggle input {\n    margin: 0;\n    cursor: pointer;\n  }\n  .ano-session-status {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n  }\n  @keyframes ano-pulse-dot { 0%,100%{opacity:1} 50%{opacity:.3} }\n  .ano-session-dot {\n    width: 8px;\n    height: 8px;\n    border-radius: 50%;\n    background: #22c55e;\n    animation: ano-pulse-dot 1s ease-in-out infinite;\n    flex-shrink: 0;\n  }\n  .ano-session-timer {\n    font-size: 13px;\n    font-weight: 600;\n    font-variant-numeric: tabular-nums;\n    color: var(--ano-text);\n    min-width: 36px;\n  }\n  .ano-session-count {\n    font-size: 12px;\n    color: var(--ano-text-secondary);\n    white-space: nowrap;\n  }\n  .ano-end-session {\n    display: flex;\n    align-items: center;\n    gap: 5px;\n    padding: 5px 12px;\n    border-radius: 8px;\n    border: none;\n    background: var(--ano-danger);\n    color: #fff;\n    cursor: pointer;\n    transition: all 0.15s;\n    font-size: 12px;\n    font-weight: 600;\n    font-family: inherit;\n    white-space: nowrap;\n  }\n  .ano-end-session:hover {\n    background: var(--ano-danger-hover);\n  }\n  .ano-btn-label {\n    font-family: inherit;\n  }\n`;\n\nexport const popoverCSS = `\n  :host {\n    all: initial;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n    font-size: 14px;\n    color: var(--ano-text);\n  }\n  * { box-sizing: border-box; margin: 0; padding: 0; }\n  .ano-popover {\n    position: fixed;\n    width: 280px;\n    background: var(--ano-bg);\n    border: 1px solid var(--ano-border);\n    border-radius: 10px;\n    box-shadow: var(--ano-shadow);\n    z-index: 2147483647;\n    overflow: hidden;\n  }\n  .ano-popover-body {\n    padding: 12px;\n  }\n  .ano-popover textarea {\n    width: 100%;\n    min-height: 60px;\n    padding: 8px;\n    border: 1px solid var(--ano-border);\n    border-radius: 6px;\n    background: var(--ano-bg-secondary);\n    color: var(--ano-text);\n    font-family: inherit;\n    font-size: 13px;\n    resize: vertical;\n    outline: none;\n    transition: border-color 0.15s;\n  }\n  .ano-popover textarea:focus {\n    border-color: var(--ano-accent);\n  }\n  .ano-popover-actions {\n    display: flex;\n    justify-content: flex-end;\n    gap: 6px;\n    padding: 8px 12px;\n    border-top: 1px solid var(--ano-border);\n    background: var(--ano-bg-secondary);\n  }\n  .ano-popover-btn {\n    padding: 5px 12px;\n    border-radius: 6px;\n    border: 1px solid var(--ano-border);\n    background: var(--ano-bg);\n    color: var(--ano-text);\n    font-size: 12px;\n    cursor: pointer;\n    transition: all 0.15s;\n  }\n  .ano-popover-btn:hover {\n    background: var(--ano-bg-hover);\n  }\n  .ano-popover-btn.save {\n    background: var(--ano-accent);\n    color: #fff;\n    border-color: var(--ano-accent);\n  }\n  .ano-popover-btn.save:hover {\n    background: var(--ano-accent-hover);\n  }\n  .ano-popover-btn.delete {\n    color: var(--ano-danger);\n    border-color: var(--ano-danger);\n  }\n  .ano-popover-btn.delete:hover {\n    background: var(--ano-danger);\n    color: #fff;\n  }\n  .ano-popover-arrow {\n    position: absolute;\n    width: 12px;\n    height: 12px;\n    background: var(--ano-bg);\n    border: 1px solid var(--ano-border);\n    transform: rotate(45deg);\n  }\n  .ano-popover-arrow.top {\n    bottom: -7px;\n    border-top: none;\n    border-left: none;\n  }\n  .ano-popover-arrow.bottom {\n    top: -7px;\n    border-bottom: none;\n    border-right: none;\n  }\n`;\n\nexport const canvasCSS = `\n  :host {\n    all: initial;\n  }\n  .ano-canvas-overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    z-index: 2147483645;\n    pointer-events: none;\n  }\n  .ano-canvas-overlay.active {\n    pointer-events: auto;\n    cursor: crosshair;\n  }\n`;\n\nexport const highlightCSS = `\n  .ano-highlight {\n    background-color: var(--ano-hl-color, #fde047);\n    cursor: pointer;\n    border-radius: 2px;\n    transition: background-color 0.15s;\n  }\n  .ano-highlight:hover {\n    filter: brightness(0.9);\n  }\n`;\n\nexport const pinCSS = `\n  .ano-pin-marker {\n    position: absolute;\n    width: 24px;\n    height: 24px;\n    border-radius: 50%;\n    background: var(--ano-pin-color, #3b82f6);\n    color: #fff;\n    font-size: 12px;\n    font-weight: 700;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    cursor: pointer;\n    z-index: 2147483644;\n    box-shadow: 0 2px 6px rgba(0,0,0,0.2);\n    transition: transform 0.15s;\n    pointer-events: auto;\n    user-select: none;\n  }\n  .ano-pin-marker:hover {\n    transform: scale(1.2);\n  }\n  .ano-pin-overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    z-index: 2147483643;\n    pointer-events: none;\n  }\n  .ano-pin-overlay.active {\n    pointer-events: auto;\n    cursor: crosshair;\n  }\n  .ano-pin-hover-outline {\n    position: absolute;\n    border: 2px dashed #3b82f6;\n    background: rgba(59, 130, 246, 0.08);\n    border-radius: 3px;\n    pointer-events: none;\n    z-index: 2147483643;\n    transition: all 0.1s;\n  }\n`;\n\nexport const endDialogCSS = `\n  :host {\n    all: initial;\n    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;\n    font-size: 14px;\n    color: var(--ano-text);\n  }\n  * { box-sizing: border-box; margin: 0; padding: 0; }\n  .ano-end-overlay {\n    position: fixed;\n    top: 0;\n    left: 0;\n    width: 100vw;\n    height: 100vh;\n    background: rgba(0,0,0,0.4);\n    z-index: 2147483647;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n  }\n  .ano-end-dialog {\n    background: var(--ano-bg);\n    border: 1px solid var(--ano-border);\n    border-radius: 14px;\n    box-shadow: var(--ano-shadow);\n    width: 400px;\n    max-width: 90vw;\n    overflow: hidden;\n  }\n  .ano-end-header {\n    display: flex;\n    align-items: center;\n    justify-content: space-between;\n    padding: 16px 20px;\n    border-bottom: 1px solid var(--ano-border);\n  }\n  .ano-end-header h2 {\n    font-size: 16px;\n    font-weight: 700;\n    color: var(--ano-text);\n  }\n  .ano-end-close {\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    width: 28px;\n    height: 28px;\n    border-radius: 6px;\n    border: none;\n    background: transparent;\n    color: var(--ano-text-secondary);\n    cursor: pointer;\n    transition: all 0.15s;\n    font-size: 18px;\n  }\n  .ano-end-close:hover {\n    background: var(--ano-bg-hover);\n    color: var(--ano-text);\n  }\n  .ano-end-summary {\n    display: grid;\n    grid-template-columns: 1fr 1fr;\n    gap: 10px;\n    padding: 20px;\n  }\n  .ano-end-stat {\n    padding: 12px;\n    border-radius: 10px;\n    background: var(--ano-bg-secondary);\n    border: 1px solid var(--ano-border);\n    text-align: center;\n  }\n  .ano-end-stat-value {\n    font-size: 22px;\n    font-weight: 700;\n    color: var(--ano-text);\n    font-variant-numeric: tabular-nums;\n  }\n  .ano-end-stat-label {\n    font-size: 11px;\n    color: var(--ano-text-secondary);\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    margin-top: 2px;\n  }\n  .ano-end-badge {\n    grid-column: 1 / -1;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    gap: 6px;\n    padding: 8px;\n    border-radius: 8px;\n    background: var(--ano-bg-secondary);\n    border: 1px solid var(--ano-border);\n    font-size: 12px;\n    color: var(--ano-text-secondary);\n  }\n  .ano-end-actions {\n    display: flex;\n    gap: 8px;\n    padding: 16px 20px;\n    border-top: 1px solid var(--ano-border);\n    justify-content: flex-end;\n  }\n  .ano-end-actions button {\n    padding: 7px 16px;\n    border-radius: 8px;\n    border: 1px solid var(--ano-border);\n    background: var(--ano-bg);\n    color: var(--ano-text);\n    font-size: 13px;\n    font-family: inherit;\n    cursor: pointer;\n    transition: all 0.15s;\n  }\n  .ano-end-actions button:hover {\n    background: var(--ano-bg-hover);\n  }\n  .ano-end-actions button.primary {\n    background: var(--ano-accent);\n    color: #fff;\n    border-color: var(--ano-accent);\n  }\n  .ano-end-actions button.primary:hover {\n    background: var(--ano-accent-hover);\n  }\n  .ano-end-actions button:disabled {\n    opacity: 0.5;\n    cursor: default;\n  }\n  .ano-end-link-result {\n    display: flex;\n    gap: 6px;\n    padding: 0 20px 16px;\n  }\n  .ano-end-link-input {\n    flex: 1;\n    padding: 7px 10px;\n    border-radius: 8px;\n    border: 1px solid var(--ano-border);\n    background: var(--ano-bg-secondary);\n    color: var(--ano-text);\n    font-size: 12px;\n    font-family: monospace;\n    outline: none;\n  }\n  .ano-end-link-copy {\n    padding: 7px 14px;\n    border-radius: 8px;\n    border: 1px solid var(--ano-accent);\n    background: var(--ano-accent);\n    color: #fff;\n    font-size: 13px;\n    font-family: inherit;\n    cursor: pointer;\n    transition: all 0.15s;\n    white-space: nowrap;\n  }\n  .ano-end-link-copy:hover {\n    background: var(--ano-accent-hover);\n  }\n  .ano-end-annotations {\n    padding: 0 20px 16px;\n  }\n  .ano-end-annotations h3 {\n    font-size: 12px;\n    font-weight: 600;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    color: var(--ano-text-secondary);\n    margin-bottom: 8px;\n  }\n  .ano-end-ann-list {\n    max-height: 280px;\n    overflow-y: auto;\n    display: flex;\n    flex-direction: column;\n    gap: 6px;\n  }\n  .ano-end-ann-card {\n    padding: 8px 10px;\n    border: 1px solid var(--ano-border);\n    border-radius: 8px;\n    background: var(--ano-bg-secondary);\n  }\n  .ano-end-ann-type {\n    display: inline-flex;\n    align-items: center;\n    gap: 5px;\n    font-size: 11px;\n    font-weight: 600;\n    text-transform: uppercase;\n    letter-spacing: 0.5px;\n    margin-bottom: 3px;\n  }\n  .ano-end-ann-type .dot {\n    width: 8px;\n    height: 8px;\n    border-radius: 50%;\n    flex-shrink: 0;\n  }\n  .ano-end-ann-type.highlight { color: #ca8a04; }\n  .ano-end-ann-type.highlight .dot { background: var(--ano-highlight); }\n  .ano-end-ann-type.pin { color: var(--ano-pin); }\n  .ano-end-ann-type.pin .dot { background: var(--ano-pin); }\n  .ano-end-ann-type.drawing { color: var(--ano-draw); }\n  .ano-end-ann-type.drawing .dot { background: var(--ano-draw); }\n  .ano-end-ann-text {\n    font-size: 13px;\n    color: var(--ano-text);\n    line-height: 1.4;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    display: -webkit-box;\n    -webkit-line-clamp: 2;\n    -webkit-box-orient: vertical;\n  }\n  .ano-end-ann-comment {\n    font-size: 12px;\n    color: var(--ano-text-secondary);\n    font-style: italic;\n    line-height: 1.4;\n    margin-top: 2px;\n    overflow: hidden;\n    text-overflow: ellipsis;\n    display: -webkit-box;\n    -webkit-line-clamp: 2;\n    -webkit-box-orient: vertical;\n  }\n`;\n\nexport function injectHostStyles() {\n  const id = 'ano-host-styles';\n  if (document.getElementById(id)) return;\n  const style = document.createElement('style');\n  style.id = id;\n  style.textContent = highlightCSS + pinCSS;\n  document.head.appendChild(style);\n}\n\nexport function removeHostStyles() {\n  document.getElementById('ano-host-styles')?.remove();\n}\n\nexport function applyTheme(host, theme) {\n  const vars = THEME[theme] || THEME.light;\n  for (const [key, value] of Object.entries(vars)) {\n    host.style.setProperty(key, value);\n  }\n}\n", "import { canvasCSS } from '../ui/styles.js';\nimport { generateCSSSelector } from '../anchoring/selector.js';\n\nexport function createDrawingManager(ctx) {\n  const { store, config } = ctx;\n  let host = null;\n  let shadow = null;\n  let canvas = null;\n  let canvasCtx = null;\n  let active = false;\n  let isDrawing = false;\n  let currentStroke = null;\n  const drawnAnnotations = new Set();\n\n  function init() {\n    if (host) return;\n\n    host = document.createElement('div');\n    host.dataset.ano = '';\n    shadow = host.attachShadow({ mode: 'open' });\n\n    const style = document.createElement('style');\n    style.textContent = canvasCSS;\n    shadow.appendChild(style);\n\n    canvas = document.createElement('canvas');\n    canvas.className = 'ano-canvas-overlay';\n    shadow.appendChild(canvas);\n\n    document.body.appendChild(host);\n\n    resizeCanvas();\n    window.addEventListener('resize', resizeCanvas);\n    window.addEventListener('scroll', redrawAll);\n  }\n\n  function resizeCanvas() {\n    if (!canvas) return;\n    const dpr = window.devicePixelRatio || 1;\n    canvas.width = window.innerWidth * dpr;\n    canvas.height = window.innerHeight * dpr;\n    canvas.style.width = window.innerWidth + 'px';\n    canvas.style.height = window.innerHeight + 'px';\n    canvasCtx = canvas.getContext('2d');\n    canvasCtx.scale(dpr, dpr);\n    redrawAll();\n  }\n\n  function enable() {\n    if (active) return;\n    init();\n    active = true;\n    canvas.classList.add('active');\n    canvas.addEventListener('pointerdown', onPointerDown);\n    canvas.addEventListener('pointermove', onPointerMove);\n    canvas.addEventListener('pointerup', onPointerUp);\n    canvas.addEventListener('pointerleave', onPointerUp);\n  }\n\n  function disable() {\n    active = false;\n    if (canvas) {\n      canvas.classList.remove('active');\n      canvas.removeEventListener('pointerdown', onPointerDown);\n      canvas.removeEventListener('pointermove', onPointerMove);\n      canvas.removeEventListener('pointerup', onPointerUp);\n      canvas.removeEventListener('pointerleave', onPointerUp);\n    }\n    if (isDrawing) {\n      finishStroke();\n    }\n  }\n\n  function onPointerDown(e) {\n    if (e.button !== 0) return;\n    isDrawing = true;\n    canvas.setPointerCapture(e.pointerId);\n\n    currentStroke = {\n      points: [{ x: e.clientX, y: e.clientY }],\n      color: config.drawColor,\n      width: config.drawWidth,\n    };\n\n    canvasCtx.beginPath();\n    canvasCtx.strokeStyle = currentStroke.color;\n    canvasCtx.lineWidth = currentStroke.width;\n    canvasCtx.lineCap = 'round';\n    canvasCtx.lineJoin = 'round';\n    canvasCtx.moveTo(e.clientX, e.clientY);\n  }\n\n  function onPointerMove(e) {\n    if (!isDrawing || !currentStroke) return;\n\n    currentStroke.points.push({ x: e.clientX, y: e.clientY });\n    canvasCtx.lineTo(e.clientX, e.clientY);\n    canvasCtx.stroke();\n    canvasCtx.beginPath();\n    canvasCtx.moveTo(e.clientX, e.clientY);\n  }\n\n  function onPointerUp() {\n    if (!isDrawing) return;\n    finishStroke();\n  }\n\n  function captureAnchor(stroke) {\n    const points = stroke.points;\n\n    let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;\n    for (const p of points) {\n      if (p.x < minX) minX = p.x;\n      if (p.y < minY) minY = p.y;\n      if (p.x > maxX) maxX = p.x;\n      if (p.y > maxY) maxY = p.y;\n    }\n    const centerX = (minX + maxX) / 2;\n    const centerY = (minY + maxY) / 2;\n\n    const prev = host.style.display;\n    host.style.display = 'none';\n    const el = document.elementFromPoint(centerX, centerY);\n    host.style.display = prev;\n\n    if (!el || el === document.documentElement) return null;\n\n    const rect = el.getBoundingClientRect();\n    if (rect.width < 1 || rect.height < 1) return null;\n\n    return {\n      selector: generateCSSSelector(el),\n      rect: { x: rect.x, y: rect.y, width: rect.width, height: rect.height },\n    };\n  }\n\n  function finishStroke() {\n    isDrawing = false;\n    if (!currentStroke || currentStroke.points.length < 2) {\n      currentStroke = null;\n      return;\n    }\n\n    const context = captureStrokeContext(currentStroke);\n    const anchor = captureAnchor(currentStroke);\n\n    let strokes;\n    if (anchor) {\n      const { rect } = anchor;\n      const relPoints = currentStroke.points.map(pt => ({\n        x: (pt.x - rect.x) / rect.width,\n        y: (pt.y - rect.y) / rect.height,\n      }));\n      strokes = [{ ...currentStroke, points: relPoints }];\n    } else {\n      strokes = [currentStroke];\n    }\n\n    const annotation = store.add({\n      type: 'drawing',\n      comment: '',\n      strokes,\n      context,\n      anchor,\n      viewport: {\n        scrollX: window.scrollX,\n        scrollY: window.scrollY,\n        width: window.innerWidth,\n        height: window.innerHeight,\n      },\n    });\n\n    drawnAnnotations.add(annotation.id);\n    // Compute viewport rect from raw stroke points for popover positioning\n    const rawPoints = currentStroke ? currentStroke.points : [];\n    currentStroke = null;\n    ctx.events.emit('drawing:created', annotation, rawPoints);\n  }\n\n  function captureStrokeContext(stroke) {\n    const points = stroke.points;\n\n    // Compute bounding box (viewport coords)\n    let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;\n    for (const p of points) {\n      if (p.x < minX) minX = p.x;\n      if (p.y < minY) minY = p.y;\n      if (p.x > maxX) maxX = p.x;\n      if (p.y > maxY) maxY = p.y;\n    }\n\n    const boundingBox = {\n      x: Math.round(minX + window.scrollX),\n      y: Math.round(minY + window.scrollY),\n      width: Math.round(maxX - minX),\n      height: Math.round(maxY - minY),\n    };\n\n    // Sample points along the stroke and hit-test for elements underneath\n    // Temporarily hide our canvas overlay so elementFromPoint sees through it\n    const prevDisplay = host.style.display;\n    host.style.display = 'none';\n\n    const seen = new Set();\n    const elements = [];\n    const sampleCount = Math.min(points.length, 20);\n    const step = Math.max(1, Math.floor(points.length / sampleCount));\n\n    for (let i = 0; i < points.length; i += step) {\n      const p = points[i];\n      const el = document.elementFromPoint(p.x, p.y);\n      if (!el || el === document.body || el === document.documentElement) continue;\n      if (el.dataset?.ano !== undefined) continue;\n\n      const selector = generateCSSSelector(el);\n      if (seen.has(selector)) continue;\n      seen.add(selector);\n\n      const text = getReadableText(el);\n      elements.push({\n        selector,\n        tagName: el.tagName,\n        text,\n        role: el.getAttribute('role') || undefined,\n        ariaLabel: el.getAttribute('aria-label') || undefined,\n      });\n    }\n\n    host.style.display = prevDisplay;\n\n    // Build human/AI-readable description\n    const parts = elements.map((e) => {\n      const tag = e.tagName.toLowerCase();\n      const label = e.text ? `${tag}(\"${truncate(e.text, 60)}\")` : tag;\n      return label;\n    });\n    const description = parts.length > 0\n      ? `Drawing over: ${parts.join(', ')}`\n      : 'Drawing on empty area';\n\n    return { boundingBox, elements, description };\n  }\n\n  function getReadableText(el) {\n    // Prefer aria-label, then alt, then direct text content\n    const aria = el.getAttribute('aria-label');\n    if (aria) return aria.trim();\n\n    const alt = el.getAttribute('alt');\n    if (alt) return alt.trim();\n\n    // Get direct text, not deeply nested text\n    // Walk immediate children to avoid grabbing too much\n    let text = '';\n    for (const child of el.childNodes) {\n      if (child.nodeType === Node.TEXT_NODE) {\n        text += child.textContent;\n      }\n    }\n    text = text.trim();\n    if (text) return text;\n\n    // Fall back to full textContent for leaf-like elements\n    const full = (el.textContent || '').trim();\n    return full.slice(0, 120);\n  }\n\n  function truncate(str, max) {\n    return str.length > max ? str.slice(0, max) + '...' : str;\n  }\n\n  function redrawAll() {\n    if (!canvasCtx) return;\n    canvasCtx.clearRect(0, 0, canvas.width, canvas.height);\n\n    const drawings = store.getByType('drawing');\n    for (const annotation of drawings) {\n      drawAnnotation(annotation);\n    }\n  }\n\n  function drawAnnotation(annotation) {\n    if (!canvasCtx || !annotation.strokes) return;\n\n    const { anchor, viewport } = annotation;\n\n    // Try to resolve the anchor element for element-relative rendering\n    let anchorRect = null;\n    if (anchor) {\n      try {\n        const el = document.querySelector(anchor.selector);\n        if (el) anchorRect = el.getBoundingClientRect();\n      } catch { /* invalid selector */ }\n    }\n\n    for (const stroke of annotation.strokes) {\n      if (stroke.points.length < 2) continue;\n\n      canvasCtx.beginPath();\n      canvasCtx.strokeStyle = stroke.color;\n      canvasCtx.lineCap = 'round';\n      canvasCtx.lineJoin = 'round';\n\n      if (anchorRect) {\n        // Anchored mode: points are fractions of the anchor element's rect\n        const scaleW = anchorRect.width / anchor.rect.width;\n        const scaleH = anchorRect.height / anchor.rect.height;\n        canvasCtx.lineWidth = stroke.width * Math.min(scaleW, scaleH);\n\n        const first = stroke.points[0];\n        canvasCtx.moveTo(\n          first.x * anchorRect.width + anchorRect.x,\n          first.y * anchorRect.height + anchorRect.y\n        );\n\n        for (let i = 1; i < stroke.points.length; i++) {\n          const pt = stroke.points[i];\n          canvasCtx.lineTo(\n            pt.x * anchorRect.width + anchorRect.x,\n            pt.y * anchorRect.height + anchorRect.y\n          );\n        }\n      } else {\n        // Legacy fallback: scroll-delta compensation\n        const scrollDx = viewport ? window.scrollX - viewport.scrollX : 0;\n        const scrollDy = viewport ? window.scrollY - viewport.scrollY : 0;\n        canvasCtx.lineWidth = stroke.width;\n\n        const first = stroke.points[0];\n        canvasCtx.moveTo(first.x - scrollDx, first.y - scrollDy);\n\n        for (let i = 1; i < stroke.points.length; i++) {\n          const pt = stroke.points[i];\n          canvasCtx.lineTo(pt.x - scrollDx, pt.y - scrollDy);\n        }\n      }\n\n      canvasCtx.stroke();\n    }\n  }\n\n  function applyDrawing(annotation) {\n    drawnAnnotations.add(annotation.id);\n    redrawAll();\n    return true;\n  }\n\n  function removeDrawing(id) {\n    drawnAnnotations.delete(id);\n    redrawAll();\n  }\n\n  function removeAll() {\n    drawnAnnotations.clear();\n    if (canvasCtx) {\n      canvasCtx.clearRect(0, 0, canvas.width, canvas.height);\n    }\n  }\n\n  function hitTest(x, y) {\n    const drawings = store.getByType('drawing');\n    for (let i = drawings.length - 1; i >= 0; i--) {\n      const ann = drawings[i];\n      const box = getViewportBox(ann);\n      if (!box) continue;\n      // Pad the hit area so thin strokes are easier to click\n      const pad = 10;\n      if (x >= box.x - pad && x <= box.x + box.width + pad &&\n          y >= box.y - pad && y <= box.y + box.height + pad) {\n        return ann;\n      }\n    }\n    return null;\n  }\n\n  function getViewportBox(annotation) {\n    const { anchor, viewport, strokes } = annotation;\n    if (!strokes || strokes.length === 0) return null;\n\n    let anchorRect = null;\n    if (anchor) {\n      try {\n        const el = document.querySelector(anchor.selector);\n        if (el) anchorRect = el.getBoundingClientRect();\n      } catch { /* invalid selector */ }\n    }\n\n    let minX = Infinity, minY = Infinity, maxX = -Infinity, maxY = -Infinity;\n    for (const stroke of strokes) {\n      for (const pt of stroke.points) {\n        let vx, vy;\n        if (anchorRect) {\n          vx = pt.x * anchorRect.width + anchorRect.x;\n          vy = pt.y * anchorRect.height + anchorRect.y;\n        } else {\n          const scrollDx = viewport ? window.scrollX - viewport.scrollX : 0;\n          const scrollDy = viewport ? window.scrollY - viewport.scrollY : 0;\n          vx = pt.x - scrollDx;\n          vy = pt.y - scrollDy;\n        }\n        if (vx < minX) minX = vx;\n        if (vy < minY) minY = vy;\n        if (vx > maxX) maxX = vx;\n        if (vy > maxY) maxY = vy;\n      }\n    }\n\n    if (!isFinite(minX)) return null;\n    return { x: minX, y: minY, width: maxX - minX, height: maxY - minY };\n  }\n\n  function destroy() {\n    disable();\n    removeAll();\n    window.removeEventListener('resize', resizeCanvas);\n    window.removeEventListener('scroll', redrawAll);\n    if (host) {\n      host.remove();\n      host = null;\n      shadow = null;\n      canvas = null;\n      canvasCtx = null;\n    }\n  }\n\n  return {\n    init,\n    enable,\n    disable,\n    applyDrawing,\n    removeDrawing,\n    removeAll,\n    redrawAll,\n    hitTest,\n    destroy,\n  };\n}\n", "export const canRecord = !!(navigator.mediaDevices?.getDisplayMedia) &&\n  !!(window.MediaRecorder) &&\n  typeof MediaRecorder.isTypeSupported === 'function' &&\n  MediaRecorder.isTypeSupported('video/webm') &&\n  !!(window.BroadcastChannel);\n\n// The popup HTML is written inline via document.write so no extra file is needed.\n// The popup holds the MediaRecorder and survives main-page navigation.\nconst RECORDER_HTML = `<!DOCTYPE html>\n<html lang=\"en\"><head><meta charset=\"UTF-8\"><title>Ano Recording</title>\n<style>\n*{box-sizing:border-box;margin:0;padding:0}\nbody{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;font-size:13px;background:#1e293b;color:#f1f5f9;display:flex;align-items:center;justify-content:center;min-height:100vh;padding:12px}\n.wrap{display:flex;align-items:center;gap:10px}\n.dot{width:10px;height:10px;border-radius:50%;background:#ef4444;animation:p 1s ease-in-out infinite;flex-shrink:0}\n@keyframes p{0%,100%{opacity:1}50%{opacity:.3}}\n.timer{font-weight:600;font-variant-numeric:tabular-nums;font-size:15px;min-width:44px}\nbutton{padding:5px 14px;border-radius:6px;border:1px solid rgba(255,255,255,.25);background:transparent;color:#fff;cursor:pointer;font-size:13px;transition:background .15s}\nbutton:hover{background:rgba(255,255,255,.12)}\n#start{background:#ef4444;border-color:#ef4444;font-weight:600;padding:8px 20px;font-size:14px}\n#start:hover{background:#dc2626}\n.msg{color:#94a3b8;font-size:12px;text-align:center}\n</style></head><body>\n<div id=\"app\"><button id=\"start\">Share Tab &amp; Record</button></div>\n<script>\nvar ch=new BroadcastChannel('ano-recording');\nvar rec,chunks=[],startTime=0,stream,timerIv;\nch.onmessage=function(e){\nif(e.data.type==='stop')doStop();\nif(e.data.type==='ping'&&rec&&rec.state==='recording')ch.postMessage({type:'pong',startTime:startTime});\n};\ndocument.getElementById('start').onclick=function(){startCapture()};\nfunction startCapture(){\nnavigator.mediaDevices.getDisplayMedia({video:{frameRate:30}}).then(function(s){\nstream=s;\nvar mime='video/webm';\nif(typeof MediaRecorder.isTypeSupported==='function'&&MediaRecorder.isTypeSupported('video/webm;codecs=vp9'))mime='video/webm;codecs=vp9';\nrec=new MediaRecorder(stream,{mimeType:mime});\nchunks=[];\nrec.ondataavailable=function(e){if(e.data.size>0)chunks.push(e.data)};\nrec.onstop=onStop;\nrec.start(500);\nstartTime=Date.now();\nstream.getVideoTracks()[0].onended=function(){doStop()};\ndocument.getElementById('app').innerHTML='<div class=\"wrap\"><span class=\"dot\"></span><span class=\"timer\" id=\"t\">0:00</span><button id=\"stopbtn\">Stop</button></div>';\ndocument.getElementById('stopbtn').onclick=function(){doStop()};\ntimerIv=setInterval(function(){\nvar sec=Math.floor((Date.now()-startTime)/1000);\nvar el=document.getElementById('t');\nif(el)el.textContent=Math.floor(sec/60)+':'+(sec%60).toString().padStart(2,'0');\n},250);\nch.postMessage({type:'started',startTime:startTime});\n}).catch(function(){\nch.postMessage({type:'cancelled'});\ntry{window.close()}catch(e){}\n});\n}\nfunction doStop(){if(!rec||rec.state==='inactive')return;rec.stop()}\nfunction onStop(){\nclearInterval(timerIv);\nif(stream)stream.getTracks().forEach(function(t){t.stop()});\nvar blob=new Blob(chunks,{type:'video/webm'});\nvar duration=Date.now()-startTime;\nch.postMessage({type:'stopped',duration:duration,blob:blob});\ndocument.getElementById('app').innerHTML='<div class=\"msg\">Recording saved. Closing\\\\u2026</div>';\nsetTimeout(function(){try{window.close()}catch(e){}},2000);\n}\nwindow.onbeforeunload=function(){if(rec&&rec.state==='recording')doStop()};\n</script></body></html>`;\n\nexport function createRecordingManager(ctx) {\n  const channel = new BroadcastChannel('ano-recording');\n  let active = false;\n  let popupWindow = null;\n  let startTime = 0;\n  let storedBlob = null;\n  let storedBlobUrl = null;\n  let storedDuration = 0;\n\n  // \u2500\u2500 BroadcastChannel messages from popup \u2500\u2500\n\n  channel.onmessage = (e) => {\n    const { data } = e;\n    if (data.type === 'started') {\n      active = true;\n      startTime = data.startTime;\n      ctx.events.emit('recording:started');\n    } else if (data.type === 'stopped') {\n      onRecordingStopped(data);\n    } else if (data.type === 'pong') {\n      if (!active) {\n        active = true;\n        startTime = data.startTime;\n      }\n    } else if (data.type === 'cancelled') {\n      ctx.events.emit('recording:cancelled');\n    }\n  };\n\n  // \u2500\u2500 Public API \u2500\u2500\n\n  function startRecording() {\n    if (active) return;\n    openPopup();\n  }\n\n  function stopRecording() {\n    channel.postMessage({ type: 'stop' });\n  }\n\n  function isRecording() {\n    return active;\n  }\n\n  // \u2500\u2500 Popup launcher \u2500\u2500\n\n  function openPopup() {\n    popupWindow = window.open(\n      '',\n      'ano-recorder',\n      'width=460,height=600,top=60,left=60',\n    );\n    if (!popupWindow) {\n      console.warn('[Ano] Popup blocked \u2014 allow popups for screen recording.');\n      ctx.events.emit('recording:cancelled');\n      return;\n    }\n    popupWindow.document.open();\n    popupWindow.document.write(RECORDER_HTML);\n    popupWindow.document.close();\n  }\n\n  // \u2500\u2500 When recording finishes \u2500\u2500\n\n  function onRecordingStopped(data) {\n    active = false;\n\n    if (data.blob) {\n      storedBlob = data.blob;\n      storedBlobUrl = URL.createObjectURL(data.blob);\n      storedDuration = data.duration || 0;\n    }\n\n    ctx.events.emit('recording:stopped', {\n      blob: storedBlob,\n      blobUrl: storedBlobUrl,\n      duration: storedDuration,\n    });\n\n    popupWindow = null;\n  }\n\n  // \u2500\u2500 Blob access \u2500\u2500\n\n  function getBlob() {\n    return storedBlob;\n  }\n\n  function getBlobUrl() {\n    return storedBlobUrl;\n  }\n\n  function clearBlob() {\n    if (storedBlobUrl) {\n      URL.revokeObjectURL(storedBlobUrl);\n    }\n    storedBlob = null;\n    storedBlobUrl = null;\n    storedDuration = 0;\n  }\n\n  // \u2500\u2500 Cleanup helpers \u2500\u2500\n\n  function removeRecording(id) {\n    const ann = ctx.store.get(id);\n    if (ann && ann.blobUrl) URL.revokeObjectURL(ann.blobUrl);\n  }\n\n  function destroy() {\n    if (active) stopRecording();\n    clearBlob();\n    try { channel.close(); } catch { /* already closed */ }\n    const recordings = ctx.store.getByType('recording');\n    for (const r of recordings) {\n      if (r.blobUrl) URL.revokeObjectURL(r.blobUrl);\n    }\n  }\n\n  // On init, check if a recording is already in progress (cross-page navigation)\n  setTimeout(() => channel.postMessage({ type: 'ping' }), 100);\n\n  return {\n    startRecording,\n    stopRecording,\n    isRecording,\n    getBlob,\n    getBlobUrl,\n    clearBlob,\n    removeRecording,\n    destroy,\n  };\n}\n", "import { generateCSSSelector } from '../anchoring/selector.js';\n\nconst STORAGE_KEY = 'ano-session';\nconst SENSITIVE_PATTERNS = /password|cc-|cvv|ssn|secret|token/i;\n\nlet idCounter = 0;\nfunction nanoid() {\n  return 'ses_' + Date.now().toString(36) + (idCounter++).toString(36) + Math.random().toString(36).slice(2, 6);\n}\n\nexport function createSessionManager(ctx) {\n  let active = false;\n  let sessionId = null;\n  let startTime = 0;\n  let actions = [];\n  let pages = [];\n  let persistTimer = null;\n  let inputTimers = new WeakMap();\n  let lastScrollY = 0;\n  let scrollTimer = null;\n\n  // Console interception\n  const originalConsole = {};\n  const CONSOLE_METHODS = ['log', 'warn', 'error', 'info'];\n\n  // \u2500\u2500 Element description \u2500\u2500\n\n  function describeElement(el) {\n    if (!el) return 'unknown';\n    const tag = el.tagName.toLowerCase();\n\n    if (tag === 'button' || (tag === 'input' && el.type === 'submit')) {\n      const text = el.textContent?.trim() || el.value || '';\n      return text ? `button(\"${truncate(text, 40)}\")` : 'button';\n    }\n    if (tag === 'a') {\n      const text = el.textContent?.trim() || '';\n      return text ? `link(\"${truncate(text, 40)}\")` : `link(${el.href || ''})`;\n    }\n    if (tag === 'input') {\n      const name = el.name || el.id || el.type;\n      return `input[name=\"${name}\"]`;\n    }\n    if (tag === 'textarea') {\n      const name = el.name || el.id || 'textarea';\n      return `textarea[name=\"${name}\"]`;\n    }\n    if (tag === 'select') {\n      const name = el.name || el.id || 'select';\n      return `select${name !== 'select' ? `[name=\"${name}\"]` : ''}`;\n    }\n    if (tag === 'label') {\n      const text = el.textContent?.trim() || '';\n      return text ? `label(\"${truncate(text, 40)}\")` : 'label';\n    }\n    if (tag === 'img') {\n      return `img(${el.alt || el.src?.split('/').pop() || ''})`;\n    }\n\n    // Generic element with text\n    const text = el.textContent?.trim();\n    if (text && text.length < 60 && el.children.length === 0) {\n      return `${tag}(\"${truncate(text, 40)}\")`;\n    }\n\n    // With id or class\n    if (el.id) return `${tag}#${el.id}`;\n    if (el.className && typeof el.className === 'string') {\n      const cls = el.className.split(/\\s+/).filter(Boolean).slice(0, 2).join('.');\n      if (cls) return `${tag}.${cls}`;\n    }\n    return tag;\n  }\n\n  function isSensitive(el) {\n    if (el.type === 'password') return true;\n    const ac = el.autocomplete || '';\n    return SENSITIVE_PATTERNS.test(ac);\n  }\n\n  function isAnoElement(el) {\n    if (!el) return false;\n    if (el.closest?.('[data-ano]')) return true;\n    let node = el;\n    while (node) {\n      if (node.host && node.host.dataset && node.host.dataset.ano !== undefined) return true;\n      node = node.parentNode;\n    }\n    return false;\n  }\n\n  // \u2500\u2500 Record action \u2500\u2500\n\n  function recordAction(action, target, selector, value, url) {\n    const entry = {\n      time: Date.now() - startTime,\n      action,\n      target: target || null,\n      selector: selector || null,\n      value: value ?? null,\n      url: url || window.location.href,\n    };\n    actions.push(entry);\n    debouncedPersist();\n    ctx.events.emit('session:action', actions.length);\n  }\n\n  // \u2500\u2500 Event handlers (named for cleanup) \u2500\u2500\n\n  function onSessionClick(e) {\n    if (isAnoElement(e.target)) return;\n    const el = e.target;\n    let selector = null;\n    try { selector = generateCSSSelector(el); } catch { /* skip */ }\n    recordAction('click', describeElement(el), selector, null);\n  }\n\n  function onSessionInput(e) {\n    if (isAnoElement(e.target)) return;\n    const el = e.target;\n\n    const prev = inputTimers.get(el);\n    if (prev) clearTimeout(prev);\n\n    const timer = setTimeout(() => {\n      inputTimers.delete(el);\n      const value = isSensitive(el) ? '[redacted]' : el.value;\n      let selector = null;\n      try { selector = generateCSSSelector(el); } catch { /* skip */ }\n      recordAction('type', describeElement(el), selector, value);\n    }, 500);\n    inputTimers.set(el, timer);\n  }\n\n  function onSessionChange(e) {\n    if (isAnoElement(e.target)) return;\n    const el = e.target;\n    const tag = el.tagName.toLowerCase();\n    const type = el.type?.toLowerCase();\n\n    if (tag === 'select') {\n      const value = el.options?.[el.selectedIndex]?.text || el.value;\n      let selector = null;\n      try { selector = generateCSSSelector(el); } catch { /* skip */ }\n      recordAction('select', describeElement(el), selector, value);\n    } else if (type === 'checkbox' || type === 'radio') {\n      const value = el.checked ? 'checked' : 'unchecked';\n      let selector = null;\n      try { selector = generateCSSSelector(el); } catch { /* skip */ }\n      recordAction('check', describeElement(el), selector, value);\n    }\n  }\n\n  function onSessionScroll() {\n    if (scrollTimer) return;\n    scrollTimer = setTimeout(() => {\n      scrollTimer = null;\n      const currentY = window.scrollY;\n      if (Math.abs(currentY - lastScrollY) < 100) return;\n      lastScrollY = currentY;\n      recordAction('scroll', null, null, `y=${Math.round(currentY)}`);\n    }, 300);\n  }\n\n  function onSessionSubmit(e) {\n    if (isAnoElement(e.target)) return;\n    const form = e.target;\n    let selector = null;\n    try { selector = generateCSSSelector(form); } catch { /* skip */ }\n    recordAction('submit', describeElement(form), selector, null);\n  }\n\n  function onSessionError(e) {\n    const msg = e.message || 'Unknown error';\n    const src = e.filename ? ` at ${e.filename}:${e.lineno}:${e.colno}` : '';\n    recordAction('error', null, null, `${msg}${src}`);\n  }\n\n  function onSessionUnhandledRejection(e) {\n    const reason = e.reason;\n    let msg;\n    if (reason instanceof Error) {\n      msg = `${reason.name}: ${reason.message}`;\n    } else {\n      try { msg = JSON.stringify(reason); } catch { msg = String(reason); }\n    }\n    recordAction('error', 'unhandledrejection', null, truncate(msg, 300));\n  }\n\n  function onSessionBeforeUnload() {\n    flushInputTimers();\n    persistToStorage();\n  }\n\n  function flushInputTimers() {\n    if (persistTimer) {\n      clearTimeout(persistTimer);\n      persistTimer = null;\n    }\n  }\n\n  // \u2500\u2500 Console interception \u2500\u2500\n\n  function patchConsole() {\n    for (const method of CONSOLE_METHODS) {\n      originalConsole[method] = console[method];\n      console[method] = (...args) => {\n        originalConsole[method].apply(console, args);\n        if (typeof args[0] === 'string' && args[0].startsWith('[Ano]')) return;\n        const value = serializeConsoleArgs(args);\n        recordAction(`console.${method}`, null, null, value);\n      };\n    }\n  }\n\n  function restoreConsole() {\n    for (const method of CONSOLE_METHODS) {\n      if (originalConsole[method]) {\n        console[method] = originalConsole[method];\n        delete originalConsole[method];\n      }\n    }\n  }\n\n  function serializeConsoleArgs(args) {\n    const parts = args.map((arg) => {\n      if (arg === null) return 'null';\n      if (arg === undefined) return 'undefined';\n      if (typeof arg === 'string') return arg;\n      if (typeof arg === 'number' || typeof arg === 'boolean') return String(arg);\n      if (arg instanceof Error) return `${arg.name}: ${arg.message}`;\n      try {\n        const json = JSON.stringify(arg);\n        return json.length > 200 ? json.slice(0, 200) + '...' : json;\n      } catch {\n        return String(arg);\n      }\n    });\n    return truncate(parts.join(' '), 500);\n  }\n\n  // \u2500\u2500 SessionStorage persistence \u2500\u2500\n\n  function persistToStorage() {\n    if (!active) return;\n    try {\n      sessionStorage.setItem(STORAGE_KEY, JSON.stringify({\n        active: true,\n        sessionId,\n        startTime,\n        actions,\n        pages,\n      }));\n    } catch { /* storage full \u2014 graceful fail */ }\n  }\n\n  function debouncedPersist() {\n    if (persistTimer) clearTimeout(persistTimer);\n    persistTimer = setTimeout(persistToStorage, 200);\n  }\n\n  function clearStorage() {\n    try { sessionStorage.removeItem(STORAGE_KEY); } catch { /* ok */ }\n  }\n\n  // \u2500\u2500 Attach / detach event listeners \u2500\u2500\n\n  function attachListeners() {\n    document.addEventListener('click', onSessionClick, true);\n    document.addEventListener('input', onSessionInput, true);\n    document.addEventListener('change', onSessionChange, true);\n    document.addEventListener('scroll', onSessionScroll, { capture: true, passive: true });\n    document.addEventListener('submit', onSessionSubmit, true);\n    window.addEventListener('beforeunload', onSessionBeforeUnload);\n    window.addEventListener('error', onSessionError);\n    window.addEventListener('unhandledrejection', onSessionUnhandledRejection);\n  }\n\n  function detachListeners() {\n    document.removeEventListener('click', onSessionClick, true);\n    document.removeEventListener('input', onSessionInput, true);\n    document.removeEventListener('change', onSessionChange, true);\n    document.removeEventListener('scroll', onSessionScroll, { capture: true });\n    document.removeEventListener('submit', onSessionSubmit, true);\n    window.removeEventListener('beforeunload', onSessionBeforeUnload);\n    window.removeEventListener('error', onSessionError);\n    window.removeEventListener('unhandledrejection', onSessionUnhandledRejection);\n  }\n\n  // \u2500\u2500 Start / stop \u2500\u2500\n\n  function start() {\n    active = true;\n    sessionId = nanoid();\n    startTime = Date.now();\n    actions = [];\n    pages = [window.location.href];\n    lastScrollY = window.scrollY;\n\n    persistToStorage();\n    attachListeners();\n    patchConsole();\n\n    return sessionId;\n  }\n\n  function resume(saved) {\n    active = true;\n    sessionId = saved.sessionId;\n    startTime = saved.startTime;\n    actions = saved.actions || [];\n    pages = saved.pages || [];\n    lastScrollY = window.scrollY;\n\n    const currentUrl = window.location.href;\n    if (!pages.includes(currentUrl)) {\n      pages.push(currentUrl);\n    }\n    recordAction('navigate', document.title, null, currentUrl, currentUrl);\n\n    attachListeners();\n    patchConsole();\n  }\n\n  function stop() {\n    if (!active) return null;\n    active = false;\n\n    flushInputTimers();\n    detachListeners();\n    restoreConsole();\n    clearStorage();\n\n    if (scrollTimer) {\n      clearTimeout(scrollTimer);\n      scrollTimer = null;\n    }\n\n    const duration = Date.now() - startTime;\n    const description = buildDescription(duration, actions, pages);\n\n    const data = {\n      sessionId,\n      duration,\n      actions: actions.slice(),\n      pages: pages.slice(),\n      description,\n    };\n\n    // Reset\n    const stoppedId = sessionId;\n    actions = [];\n    pages = [];\n    startTime = 0;\n    sessionId = null;\n\n    return data;\n  }\n\n  // \u2500\u2500 Context description \u2500\u2500\n\n  function buildDescription(duration, actionList, pageList) {\n    const secs = Math.round(duration / 1000);\n    const lines = [`Session (${secs}s, ${actionList.length} actions, ${pageList.length} pages):`];\n\n    for (let i = 0; i < actionList.length; i++) {\n      const a = actionList[i];\n      const t = (a.time / 1000).toFixed(1);\n      let line;\n\n      switch (a.action) {\n        case 'click':\n          line = `Clicked ${a.target}`;\n          break;\n        case 'type':\n          line = `Typed \"${truncate(a.value || '', 40)}\" in ${a.target}`;\n          break;\n        case 'select':\n          line = `Selected \"${a.value}\" in ${a.target}`;\n          break;\n        case 'check':\n          line = `${a.value === 'checked' ? 'Checked' : 'Unchecked'} ${a.target}`;\n          break;\n        case 'scroll':\n          line = `Scrolled to ${a.value}`;\n          break;\n        case 'submit':\n          line = `Submitted ${a.target}`;\n          break;\n        case 'navigate':\n          line = `Navigated to ${a.value}`;\n          break;\n        case 'console.log':\n          line = `console.log: ${truncate(a.value || '', 80)}`;\n          break;\n        case 'console.warn':\n          line = `console.warn: ${truncate(a.value || '', 80)}`;\n          break;\n        case 'console.error':\n          line = `console.error: ${truncate(a.value || '', 80)}`;\n          break;\n        case 'console.info':\n          line = `console.info: ${truncate(a.value || '', 80)}`;\n          break;\n        case 'error':\n          line = `ERROR: ${truncate(a.value || '', 80)}`;\n          break;\n        default:\n          line = `${a.action} ${a.target || ''}`;\n      }\n\n      lines.push(`${i + 1}. [${t}s] ${line}`);\n    }\n\n    return lines.join('\\n');\n  }\n\n  // \u2500\u2500 Public API \u2500\u2500\n\n  function isActive() {\n    return active;\n  }\n\n  function getSessionId() {\n    return sessionId;\n  }\n\n  function getStartTime() {\n    return startTime;\n  }\n\n  function getActionCount() {\n    return actions.length;\n  }\n\n  function removeSession(id) {\n    // No blob cleanup needed for sessions\n  }\n\n  // \u2500\u2500 Destroy \u2500\u2500\n\n  function destroy() {\n    if (active) {\n      active = false;\n      detachListeners();\n      restoreConsole();\n      clearStorage();\n      if (scrollTimer) {\n        clearTimeout(scrollTimer);\n        scrollTimer = null;\n      }\n      if (persistTimer) {\n        clearTimeout(persistTimer);\n        persistTimer = null;\n      }\n    }\n    actions = [];\n    pages = [];\n    sessionId = null;\n  }\n\n  // \u2500\u2500 Check for active session from previous page \u2500\u2500\n\n  function checkResume() {\n    try {\n      const raw = sessionStorage.getItem(STORAGE_KEY);\n      if (!raw) return;\n      const saved = JSON.parse(raw);\n      if (saved && saved.active) {\n        resume(saved);\n        ctx.events.emit('session:resumed', {\n          sessionId: saved.sessionId,\n          startTime: saved.startTime,\n        });\n      }\n    } catch { /* corrupt data \u2014 ignore */ }\n  }\n\n  // Auto-check on creation\n  setTimeout(checkResume, 50);\n\n  return {\n    start,\n    stop,\n    isActive,\n    getSessionId,\n    getStartTime,\n    getActionCount,\n    checkResume,\n    removeSession,\n    destroy,\n  };\n}\n\nfunction truncate(str, max) {\n  if (!str) return '';\n  return str.length > max ? str.slice(0, max) + '...' : str;\n}\n", "export function el(tag, attrs = {}, ...children) {\n  const element = document.createElement(tag);\n  for (const [key, value] of Object.entries(attrs)) {\n    if (key === 'className') {\n      element.className = value;\n    } else if (key === 'style' && typeof value === 'object') {\n      Object.assign(element.style, value);\n    } else if (key.startsWith('on') && typeof value === 'function') {\n      element.addEventListener(key.slice(2).toLowerCase(), value);\n    } else if (key === 'html') {\n      element.innerHTML = value;\n    } else {\n      element.setAttribute(key, value);\n    }\n  }\n  for (const child of children) {\n    if (child == null) continue;\n    if (typeof child === 'string') {\n      element.appendChild(document.createTextNode(child));\n    } else {\n      element.appendChild(child);\n    }\n  }\n  return element;\n}\n\nexport function svg(name) {\n  const icons = {\n    highlight: '<svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7\"/><path d=\"M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z\"/></svg>',\n    pin: '<svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z\"/><circle cx=\"12\" cy=\"10\" r=\"3\"/></svg>',\n    draw: '<svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M12 19l7-7 3 3-7 7-3-3z\"/><path d=\"M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z\"/><path d=\"M2 2l7.586 7.586\"/></svg>',\n    navigate: '<svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M3 11l19-9-9 19-2-8-8-2z\"/></svg>',\n    close: '<svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><line x1=\"18\" y1=\"6\" x2=\"6\" y2=\"18\"/><line x1=\"6\" y1=\"6\" x2=\"18\" y2=\"18\"/></svg>',\n    download: '<svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"/><polyline points=\"7 10 12 15 17 10\"/><line x1=\"12\" y1=\"15\" x2=\"12\" y2=\"3\"/></svg>',\n    upload: '<svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4\"/><polyline points=\"17 8 12 3 7 8\"/><line x1=\"12\" y1=\"3\" x2=\"12\" y2=\"15\"/></svg>',\n    trash: '<svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><polyline points=\"3 6 5 6 21 6\"/><path d=\"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2\"/></svg>',\n    chevron: '<svg width=\"12\" height=\"12\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><polyline points=\"9 18 15 12 9 6\"/></svg>',\n    record: '<svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><circle cx=\"12\" cy=\"12\" r=\"10\"/><circle cx=\"12\" cy=\"12\" r=\"4\" fill=\"currentColor\" stroke=\"none\"/></svg>',\n    stop: '<svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><rect x=\"6\" y=\"6\" width=\"12\" height=\"12\" rx=\"1\" fill=\"currentColor\" stroke=\"none\"/></svg>',\n    session: '<svg width=\"18\" height=\"18\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><polyline points=\"22 12 18 12 15 21 9 3 6 12 2 12\"/></svg>',\n    annotation: '<svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z\"/></svg>',\n    link: '<svg width=\"14\" height=\"14\" viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M10 13a5 5 0 0 0 7.54.54l3-3a5 5 0 0 0-7.07-7.07l-1.72 1.71\"/><path d=\"M14 11a5 5 0 0 0-7.54-.54l-3 3a5 5 0 0 0 7.07 7.07l1.71-1.71\"/></svg>',\n  };\n  const wrapper = document.createElement('span');\n  wrapper.innerHTML = icons[name] || '';\n  wrapper.style.display = 'inline-flex';\n  wrapper.style.alignItems = 'center';\n  return wrapper;\n}\n\nexport function formatTime(ts) {\n  const d = new Date(ts);\n  const h = d.getHours().toString().padStart(2, '0');\n  const m = d.getMinutes().toString().padStart(2, '0');\n  return `${h}:${m}`;\n}\n", "import { toolbarCSS } from './styles.js';\nimport { el, svg } from './components.js';\nimport { applyTheme } from './styles.js';\nimport { canRecord } from '../annotations/recording.js';\n\nconst ANNOTATE_MODES = [\n  { id: 'highlight', label: 'Highlight', icon: 'highlight', shortcut: 'Alt+H' },\n  { id: 'pin', label: 'Pin', icon: 'pin', shortcut: 'Alt+P' },\n  { id: 'draw', label: 'Draw', icon: 'draw', shortcut: 'Alt+D' },\n  { id: 'navigate', label: 'Navigate', icon: 'navigate', shortcut: 'Alt+N' },\n];\n\nexport function createToolbar(ctx) {\n  let host = null;\n  let shadow = null;\n  let toolbarEl = null;\n  let buttons = {};\n  let timerEl = null;\n  let countEl = null;\n  let timerInterval = null;\n  let videoCheckbox = null;\n\n  function render() {\n    host = document.createElement('div');\n    host.dataset.ano = '';\n    shadow = host.attachShadow({ mode: 'open' });\n\n    const style = document.createElement('style');\n    style.textContent = toolbarCSS;\n    shadow.appendChild(style);\n\n    applyTheme(host, ctx.config.theme);\n\n    toolbarEl = el('div', { className: 'ano-toolbar' });\n    shadow.appendChild(toolbarEl);\n    document.body.appendChild(host);\n\n    renderIdle();\n  }\n\n  function renderIdle() {\n    clearTimer();\n    buttons = {};\n    toolbarEl.innerHTML = '';\n\n    // Start Session button\n    const startBtn = el('button', {\n      className: 'ano-start-session',\n      onClick: () => ctx.events.emit('session:start'),\n    },\n      svg('session'),\n      el('span', { className: 'ano-btn-label' }, 'Start Session'),\n    );\n    toolbarEl.appendChild(startBtn);\n\n    // Video toggle (only if recording is supported)\n    if (canRecord) {\n      const label = el('label', { className: 'ano-video-toggle' });\n      videoCheckbox = document.createElement('input');\n      videoCheckbox.type = 'checkbox';\n      videoCheckbox.checked = ctx.config.videoRecording;\n      label.appendChild(videoCheckbox);\n      label.appendChild(svg('record'));\n      label.appendChild(document.createTextNode('Video'));\n      toolbarEl.appendChild(label);\n    }\n  }\n\n  function renderActive(startTime) {\n    clearTimer();\n    buttons = {};\n    toolbarEl.innerHTML = '';\n\n    // Annotation tool buttons\n    for (const mode of ANNOTATE_MODES) {\n      const btn = el('button', {\n        className: 'ano-toolbar-btn',\n        title: mode.label,\n        onClick: () => ctx.setMode(mode.id),\n      },\n        svg(mode.icon),\n        el('span', { className: 'tooltip' }, `${mode.label} (${mode.shortcut})`),\n      );\n      buttons[mode.id] = btn;\n      toolbarEl.appendChild(btn);\n    }\n\n    // Divider\n    toolbarEl.appendChild(el('div', { className: 'ano-toolbar-divider' }));\n\n    // Session status area\n    const status = el('div', { className: 'ano-session-status' });\n\n    status.appendChild(el('span', { className: 'ano-session-dot' }));\n\n    timerEl = el('span', { className: 'ano-session-timer' }, '0:00');\n    status.appendChild(timerEl);\n\n    countEl = el('span', { className: 'ano-session-count' }, '(0)');\n    status.appendChild(countEl);\n\n    const endBtn = el('button', {\n      className: 'ano-end-session',\n      onClick: () => ctx.events.emit('session:end'),\n    },\n      svg('stop'),\n      el('span', { className: 'ano-btn-label' }, 'End'),\n    );\n    status.appendChild(endBtn);\n\n    toolbarEl.appendChild(status);\n\n    // Start timer\n    const updateTimerFn = () => {\n      if (!timerEl) return;\n      const elapsed = Date.now() - startTime;\n      const secs = Math.floor(elapsed / 1000);\n      const m = Math.floor(secs / 60);\n      const s = secs % 60;\n      timerEl.textContent = `${m}:${s.toString().padStart(2, '0')}`;\n    };\n    updateTimerFn();\n    timerInterval = setInterval(updateTimerFn, 250);\n  }\n\n  function updateCount(n) {\n    if (countEl) countEl.textContent = `(${n})`;\n  }\n\n  function getVideoToggleState() {\n    return videoCheckbox ? videoCheckbox.checked : false;\n  }\n\n  function setActive(modeId) {\n    for (const [id, btn] of Object.entries(buttons)) {\n      btn.classList.toggle('active', id === modeId);\n    }\n  }\n\n  function clearTimer() {\n    if (timerInterval) {\n      clearInterval(timerInterval);\n      timerInterval = null;\n    }\n    timerEl = null;\n    countEl = null;\n  }\n\n  function updateTheme(theme) {\n    if (host) applyTheme(host, theme);\n  }\n\n  function destroy() {\n    clearTimer();\n    if (host) {\n      host.remove();\n      host = null;\n      shadow = null;\n      toolbarEl = null;\n      buttons = {};\n      videoCheckbox = null;\n    }\n  }\n\n  return { render, renderIdle, renderActive, setActive, updateCount, getVideoToggleState, updateTheme, destroy };\n}\n", "import { popoverCSS } from './styles.js';\nimport { el } from './components.js';\nimport { applyTheme } from './styles.js';\n\nexport function createPopoverManager(ctx) {\n  const { store } = ctx;\n  let host = null;\n  let shadow = null;\n  let currentId = null;\n  let cleanupClickOutside = null;\n\n  function init() {\n    if (host) return;\n    host = document.createElement('div');\n    host.dataset.ano = '';\n    shadow = host.attachShadow({ mode: 'open' });\n\n    const style = document.createElement('style');\n    style.textContent = popoverCSS;\n    shadow.appendChild(style);\n\n    applyTheme(host, ctx.config.theme);\n    document.body.appendChild(host);\n  }\n\n  function show(annotationId, anchorRect) {\n    init();\n    hide();\n    currentId = annotationId;\n\n    const annotation = store.get(annotationId);\n    if (!annotation) return;\n\n    const popover = el('div', { className: 'ano-popover' });\n\n    const body = el('div', { className: 'ano-popover-body' });\n    const textarea = el('textarea', {\n      placeholder: 'Add a comment...',\n    });\n    textarea.value = annotation.comment || '';\n    body.appendChild(textarea);\n    popover.appendChild(body);\n\n    const actions = el('div', { className: 'ano-popover-actions' });\n\n    const deleteBtn = el('button', {\n      className: 'ano-popover-btn delete',\n      onClick: () => {\n        ctx.events.emit('annotation:delete', annotationId);\n        hide();\n      },\n    }, 'Delete');\n\n    const cancelBtn = el('button', {\n      className: 'ano-popover-btn',\n      onClick: () => hide(),\n    }, 'Cancel');\n\n    const saveBtn = el('button', {\n      className: 'ano-popover-btn save',\n      onClick: () => {\n        store.update(annotationId, { comment: textarea.value });\n        hide();\n      },\n    }, 'Save');\n\n    actions.appendChild(deleteBtn);\n    actions.appendChild(cancelBtn);\n    actions.appendChild(saveBtn);\n    popover.appendChild(actions);\n\n    // Add arrow\n    const arrow = el('div', { className: 'ano-popover-arrow' });\n    popover.appendChild(arrow);\n\n    shadow.appendChild(popover);\n\n    // Position with flip logic\n    requestAnimationFrame(() => {\n      positionPopover(popover, arrow, anchorRect);\n      textarea.focus();\n\n      // Click outside \u2192 save and close\n      function onClickOutside(e) {\n        if (host && !host.shadowRoot.contains(e.target) && !host.contains(e.target)) {\n          store.update(annotationId, { comment: textarea.value });\n          hide();\n        }\n      }\n      document.addEventListener('click', onClickOutside, true);\n      cleanupClickOutside = () => {\n        document.removeEventListener('click', onClickOutside, true);\n      };\n    });\n\n    // Handle keyboard\n    textarea.addEventListener('keydown', (e) => {\n      if (e.key === 'Enter' && (e.metaKey || e.ctrlKey)) {\n        store.update(annotationId, { comment: textarea.value });\n        hide();\n      }\n      if (e.key === 'Escape') {\n        store.update(annotationId, { comment: textarea.value });\n        hide();\n      }\n      e.stopPropagation();\n    });\n  }\n\n  function positionPopover(popover, arrow, anchor) {\n    const popRect = popover.getBoundingClientRect();\n    const viewW = window.innerWidth;\n    const viewH = window.innerHeight;\n\n    let top, left;\n    let arrowPos = 'top'; // popover is below anchor, arrow points up\n\n    // Try positioning below\n    top = anchor.bottom + 8;\n    if (top + popRect.height > viewH) {\n      // Flip above\n      top = anchor.top - popRect.height - 8;\n      arrowPos = 'bottom';\n    }\n\n    // Horizontal centering\n    left = anchor.left + (anchor.width / 2) - (popRect.width / 2);\n    left = Math.max(8, Math.min(left, viewW - popRect.width - 8));\n\n    popover.style.top = `${top}px`;\n    popover.style.left = `${left}px`;\n\n    // Position arrow\n    arrow.className = `ano-popover-arrow ${arrowPos}`;\n    const arrowLeft = anchor.left + (anchor.width / 2) - left - 6;\n    arrow.style.left = `${Math.max(12, Math.min(arrowLeft, popRect.width - 24))}px`;\n  }\n\n  function hide() {\n    if (cleanupClickOutside) {\n      cleanupClickOutside();\n      cleanupClickOutside = null;\n    }\n    if (!shadow) return;\n    const existing = shadow.querySelector('.ano-popover');\n    if (existing) existing.remove();\n    currentId = null;\n  }\n\n  function isOpen() {\n    return currentId !== null;\n  }\n\n  function getCurrentId() {\n    return currentId;\n  }\n\n  function updateTheme(theme) {\n    if (host) applyTheme(host, theme);\n  }\n\n  function destroy() {\n    hide();\n    if (host) {\n      host.remove();\n      host = null;\n      shadow = null;\n    }\n  }\n\n  return { init, show, hide, isOpen, getCurrentId, updateTheme, destroy };\n}\n", "import { endDialogCSS } from './styles.js';\nimport { el, svg } from './components.js';\nimport { applyTheme } from './styles.js';\n\nexport function createEndDialog(ctx) {\n  let host = null;\n  let shadow = null;\n\n  function show(summary) {\n    hide();\n\n    host = document.createElement('div');\n    host.dataset.ano = '';\n    shadow = host.attachShadow({ mode: 'open' });\n\n    const style = document.createElement('style');\n    style.textContent = endDialogCSS;\n    shadow.appendChild(style);\n\n    applyTheme(host, ctx.config.theme);\n\n    // Overlay\n    const overlay = el('div', { className: 'ano-end-overlay' });\n    overlay.addEventListener('click', (e) => {\n      if (e.target === overlay) dismiss();\n    });\n\n    // Dialog\n    const dialog = el('div', { className: 'ano-end-dialog' });\n\n    // Header\n    const closeBtn = el('button', {\n      className: 'ano-end-close',\n      onClick: () => dismiss(),\n    });\n    closeBtn.appendChild(svg('close'));\n    dialog.appendChild(el('div', { className: 'ano-end-header' },\n      el('h2', {}, 'Report Ready'),\n      closeBtn,\n    ));\n\n    // Summary grid\n    const grid = el('div', { className: 'ano-end-summary' });\n\n    grid.appendChild(statCard(formatDuration(summary.duration), 'Duration'));\n    grid.appendChild(statCard(String(summary.actionCount), 'Actions'));\n    grid.appendChild(statCard(String(summary.pageCount), 'Pages'));\n    grid.appendChild(statCard(String(summary.annotationCount), 'Annotations'));\n\n    if (summary.hasRecording) {\n      const badge = el('div', { className: 'ano-end-badge' });\n      badge.appendChild(svg('record'));\n      badge.appendChild(document.createTextNode('Video recorded'));\n      grid.appendChild(badge);\n    }\n\n    dialog.appendChild(grid);\n\n    // Annotation list\n    if (summary.annotations && summary.annotations.length > 0) {\n      const section = el('div', { className: 'ano-end-annotations' });\n      section.appendChild(el('h3', {}, 'Annotations'));\n\n      const list = el('div', { className: 'ano-end-ann-list' });\n\n      let pinIndex = 0;\n      for (const ann of summary.annotations) {\n        if (ann.type === 'session' || ann.type === 'recording') continue;\n\n        const card = el('div', { className: 'ano-end-ann-card' });\n\n        if (ann.type === 'highlight') {\n          card.appendChild(typeLabel('highlight', 'Highlight'));\n          if (ann.quote) card.appendChild(el('div', { className: 'ano-end-ann-text' }, `\"${truncate(ann.quote, 120)}\"`));\n        } else if (ann.type === 'pin') {\n          pinIndex++;\n          card.appendChild(typeLabel('pin', `Pin #${pinIndex}`));\n          if (ann.target?.description) card.appendChild(el('div', { className: 'ano-end-ann-text' }, ann.target.description));\n        } else if (ann.type === 'drawing') {\n          card.appendChild(typeLabel('drawing', 'Drawing'));\n        }\n\n        if (ann.comment) {\n          card.appendChild(el('div', { className: 'ano-end-ann-comment' }, ann.comment));\n        }\n\n        list.appendChild(card);\n      }\n\n      section.appendChild(list);\n      dialog.appendChild(section);\n    }\n\n    // Actions\n    const actions = el('div', { className: 'ano-end-actions' });\n\n    const dismissBtn = el('button', {\n      onClick: () => dismiss(),\n    }, 'Dismiss');\n\n    const linkBtn = el('button', {\n      onClick: () => {\n        linkBtn.textContent = 'Uploading\u2026';\n        linkBtn.disabled = true;\n        ctx.events.emit('share');\n      },\n    }, 'Get Link');\n\n    // Share result \u2014 show URL inline\n    const linkResult = el('div', { className: 'ano-end-link-result' });\n    linkResult.style.display = 'none';\n\n    const linkInput = el('input', { readOnly: true, className: 'ano-end-link-input' });\n    const copyBtn = el('button', {\n      className: 'ano-end-link-copy',\n      onClick: () => {\n        navigator.clipboard.writeText(linkInput.value).then(() => {\n          copyBtn.textContent = 'Copied!';\n          setTimeout(() => { copyBtn.textContent = 'Copy'; }, 2000);\n        });\n      },\n    }, 'Copy');\n\n    linkResult.appendChild(linkInput);\n    linkResult.appendChild(copyBtn);\n\n    const offComplete = ctx.events.on('share:complete', (url) => {\n      linkBtn.style.display = 'none';\n      linkInput.value = url;\n      linkResult.style.display = '';\n    });\n\n    const offError = ctx.events.on('share:error', () => {\n      linkBtn.textContent = 'Failed \u2014 retry';\n      linkBtn.disabled = false;\n    });\n\n    // Clean up listeners when dialog closes\n    const origHide = hide;\n    hide = function () {\n      offComplete();\n      offError();\n      origHide();\n    };\n\n    const exportJsonBtn = el('button', {\n      className: 'primary',\n      onClick: () => {\n        ctx.events.emit('export:json');\n        dismiss();\n      },\n    }, 'Export JSON');\n\n    actions.appendChild(dismissBtn);\n    actions.appendChild(linkBtn);\n\n    if (summary.hasRecording) {\n      const exportVideoBtn = el('button', {\n        onClick: () => {\n          ctx.events.emit('export:video');\n          dismiss();\n        },\n      }, 'Export Video');\n      actions.appendChild(exportVideoBtn);\n    }\n\n    actions.appendChild(exportJsonBtn);\n    dialog.appendChild(actions);\n    dialog.appendChild(linkResult);\n\n    overlay.appendChild(dialog);\n    shadow.appendChild(overlay);\n    document.body.appendChild(host);\n  }\n\n  function statCard(value, label) {\n    return el('div', { className: 'ano-end-stat' },\n      el('div', { className: 'ano-end-stat-value' }, value),\n      el('div', { className: 'ano-end-stat-label' }, label),\n    );\n  }\n\n  function typeLabel(type, text) {\n    const label = el('div', { className: `ano-end-ann-type ${type}` });\n    label.appendChild(el('span', { className: 'dot' }));\n    label.appendChild(document.createTextNode(text));\n    return label;\n  }\n\n  function truncate(str, max) {\n    if (!str || str.length <= max) return str || '';\n    return str.slice(0, max) + '\u2026';\n  }\n\n  function formatDuration(ms) {\n    const secs = Math.floor((ms || 0) / 1000);\n    const m = Math.floor(secs / 60);\n    const s = secs % 60;\n    return `${m}:${s.toString().padStart(2, '0')}`;\n  }\n\n  function dismiss() {\n    hide();\n    ctx.events.emit('session:dismissed');\n  }\n\n  function hide() {\n    if (host) {\n      host.remove();\n      host = null;\n      shadow = null;\n    }\n  }\n\n  function isOpen() {\n    return host !== null;\n  }\n\n  function destroy() {\n    hide();\n  }\n\n  return { show, hide, dismiss, isOpen, destroy };\n}\n", "export function createShortcutManager(ctx) {\n  let active = false;\n\n  const shortcuts = {\n    'alt+h': () => {\n      if (ctx.sessionState === 'active') ctx.setMode('highlight');\n    },\n    'alt+p': () => {\n      if (ctx.sessionState === 'active') ctx.setMode('pin');\n    },\n    'alt+d': () => {\n      if (ctx.sessionState === 'active') ctx.setMode('draw');\n    },\n    'alt+n': () => {\n      if (ctx.sessionState === 'active') ctx.setMode('navigate');\n    },\n    'alt+s': () => {\n      if (ctx.sessionState === 'idle') {\n        ctx.events.emit('session:start');\n      } else if (ctx.sessionState === 'active') {\n        ctx.events.emit('session:end');\n      }\n    },\n    'alt+e': () => ctx.events.emit('export'),\n    'escape': () => {\n      if (ctx.popover.isOpen()) {\n        ctx.popover.hide();\n      } else if (ctx.sessionState === 'active') {\n        ctx.events.emit('session:end');\n      } else if (ctx.endDialog && ctx.endDialog.isOpen()) {\n        ctx.endDialog.dismiss();\n      }\n    },\n  };\n\n  function onKeyDown(e) {\n    const tag = e.target.tagName;\n    if (tag === 'INPUT' || tag === 'TEXTAREA' || tag === 'SELECT') {\n      if (e.key === 'Escape') {\n        const isAnoElement = e.target.closest?.('[data-ano]') || isInShadow(e.target);\n        if (isAnoElement) {\n          shortcuts['escape']();\n          return;\n        }\n      }\n      return;\n    }\n\n    const key = buildKey(e);\n    if (shortcuts[key]) {\n      e.preventDefault();\n      e.stopPropagation();\n      shortcuts[key]();\n    }\n  }\n\n  function buildKey(e) {\n    const parts = [];\n    if (e.altKey) parts.push('alt');\n    if (e.ctrlKey) parts.push('ctrl');\n    if (e.metaKey) parts.push('meta');\n    if (e.shiftKey) parts.push('shift');\n    parts.push(e.key.toLowerCase());\n    return parts.join('+');\n  }\n\n  function isInShadow(el) {\n    let node = el;\n    while (node) {\n      if (node.host && node.host.dataset && node.host.dataset.ano !== undefined) return true;\n      node = node.parentNode;\n    }\n    return false;\n  }\n\n  function enable() {\n    if (active) return;\n    active = true;\n    document.addEventListener('keydown', onKeyDown, true);\n  }\n\n  function disable() {\n    active = false;\n    document.removeEventListener('keydown', onKeyDown, true);\n  }\n\n  function destroy() {\n    disable();\n  }\n\n  return { enable, disable, destroy };\n}\n", "export function exportAnnotations(store, crossPageAnnotations = []) {\n  const data = buildExportData(store, crossPageAnnotations);\n  const json = JSON.stringify(data, null, 2);\n  const blob = new Blob([json], { type: 'application/json' });\n  const url = URL.createObjectURL(blob);\n\n  const a = document.createElement('a');\n  a.href = url;\n  a.download = `annotations-${formatDate()}.json`;\n  a.style.display = 'none';\n  document.body.appendChild(a);\n  a.click();\n\n  setTimeout(() => {\n    URL.revokeObjectURL(url);\n    a.remove();\n  }, 100);\n\n  // Export recording .webm files as separate downloads\n  const recordings = store.getByType('recording');\n  for (const rec of recordings) {\n    if (rec.blob) {\n      downloadBlob(rec.blob, `recording-${rec.id}.webm`);\n    }\n  }\n\n  // Export session video blobs\n  const sessions = store.getByType('session');\n  for (const ses of sessions) {\n    if (ses.blob) {\n      downloadBlob(ses.blob, `session-${ses.sessionId || ses.id}.webm`);\n    }\n  }\n\n  return data;\n}\n\nexport function exportJSON(store, crossPageAnnotations = []) {\n  const data = buildExportData(store, crossPageAnnotations);\n  const json = JSON.stringify(data, null, 2);\n  const blob = new Blob([json], { type: 'application/json' });\n  const url = URL.createObjectURL(blob);\n\n  const a = document.createElement('a');\n  a.href = url;\n  a.download = `annotations-${formatDate()}.json`;\n  a.style.display = 'none';\n  document.body.appendChild(a);\n  a.click();\n\n  setTimeout(() => {\n    URL.revokeObjectURL(url);\n    a.remove();\n  }, 100);\n\n  return data;\n}\n\nexport function exportVideo(store) {\n  const recordings = store.getByType('recording');\n  for (const rec of recordings) {\n    if (rec.blob) {\n      downloadBlob(rec.blob, `recording-${rec.id}.webm`);\n    }\n  }\n\n  const sessions = store.getByType('session');\n  for (const ses of sessions) {\n    if (ses.blob) {\n      downloadBlob(ses.blob, `session-${ses.sessionId || ses.id}.webm`);\n    }\n  }\n}\n\nfunction downloadBlob(blob, filename) {\n  const url = URL.createObjectURL(blob);\n  const a = document.createElement('a');\n  a.href = url;\n  a.download = filename;\n  a.style.display = 'none';\n  document.body.appendChild(a);\n  a.click();\n  setTimeout(() => {\n    URL.revokeObjectURL(url);\n    a.remove();\n  }, 100);\n}\n\nexport function buildExportData(store, crossPageAnnotations = []) {\n  // Current page's annotations (from in-memory store \u2014 freshest)\n  const currentAnnotations = store.getAll().map((a) => {\n    const c = cleanAnnotation(a);\n    c.pageUrl = c.pageUrl || window.location.href;\n    c.pageTitle = c.pageTitle || document.title;\n    return c;\n  });\n\n  // Other pages' annotations (from localStorage via api.js)\n  const otherAnnotations = crossPageAnnotations.map((a) => {\n    const c = cleanAnnotation(a);\n    c.pageUrl = c.pageUrl || a.pageUrl || 'unknown';\n    c.pageTitle = c.pageTitle || a.pageTitle || '';\n    return c;\n  });\n\n  // Merge and deduplicate by id (current page wins)\n  const seen = new Set(currentAnnotations.map((a) => a.id));\n  const merged = [...currentAnnotations];\n  for (const a of otherAnnotations) {\n    if (!seen.has(a.id)) {\n      seen.add(a.id);\n      merged.push(a);\n    }\n  }\n\n  // Sort by creation time\n  merged.sort((a, b) => a.createdAt - b.createdAt);\n\n  return {\n    version: '1.0',\n    exportedAt: new Date().toISOString(),\n    pageUrl: window.location.href,\n    pageTitle: document.title,\n    environment: collectEnvironment(),\n    annotations: merged,\n    summary: buildSummary(merged),\n  };\n}\n\nfunction collectEnvironment() {\n  const nav = navigator;\n  const scr = screen;\n  const conn = nav.connection || nav.mozConnection || nav.webkitConnection;\n\n  const env = {\n    userAgent: nav.userAgent,\n    platform: nav.platform,\n    language: nav.language,\n    languages: nav.languages ? [...nav.languages] : [nav.language],\n    timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,\n    timezoneOffset: new Date().getTimezoneOffset(),\n    screen: {\n      width: scr.width,\n      height: scr.height,\n      devicePixelRatio: window.devicePixelRatio,\n      colorDepth: scr.colorDepth,\n      orientation: scr.orientation?.type || null,\n    },\n    viewport: {\n      width: window.innerWidth,\n      height: window.innerHeight,\n    },\n    deviceMemory: nav.deviceMemory || null,\n    hardwareConcurrency: nav.hardwareConcurrency || null,\n    touchSupport: nav.maxTouchPoints > 0,\n    cookiesEnabled: nav.cookieEnabled,\n    doNotTrack: nav.doNotTrack || null,\n  };\n\n  if (conn) {\n    env.connection = {\n      effectiveType: conn.effectiveType || null,\n      downlink: conn.downlink || null,\n      rtt: conn.rtt || null,\n      saveData: conn.saveData || false,\n    };\n  }\n\n  return env;\n}\n\nfunction cleanAnnotation(a) {\n  const clean = {};\n\n  // Common fields\n  clean.id = a.id;\n  clean.type = a.type;\n  clean.comment = a.comment || '';\n  clean.createdAt = a.createdAt;\n\n  if (a.type === 'highlight') {\n    clean.text = a.text;\n    clean.context = a.context || null;\n    // Keep selectors for re-import, but nest under _anchoring\n    clean._anchoring = { selectors: a.selectors };\n    if (a.color) clean.color = a.color;\n  } else if (a.type === 'pin') {\n    clean.index = a.index;\n    clean.context = a.context || null;\n    // Keep target info for re-import\n    clean._anchoring = {\n      targetSelector: a.targetSelector,\n      targetMeta: a.targetMeta,\n    };\n  } else if (a.type === 'drawing') {\n    clean.context = a.context || null;\n    // Keep strokes for re-import and rendering\n    clean._anchoring = {\n      strokes: a.strokes,\n      viewport: a.viewport,\n    };\n  } else if (a.type === 'recording') {\n    clean.duration = a.duration;\n    clean.region = a.region;\n    clean.context = a.context || null;\n    clean._anchoring = {\n      viewport: a.viewport,\n      file: `recording-${a.id}.webm`,\n    };\n  } else if (a.type === 'session') {\n    clean.duration = a.duration;\n    clean.pages = a.pages;\n    clean.context = a.context || null;\n    clean.sessionId = a.sessionId || null;\n    clean.annotationIds = a.annotationIds || [];\n    clean.hasRecording = a.hasRecording || false;\n    clean._anchoring = {\n      actions: a.actions,\n    };\n    if (a.blob) {\n      clean._anchoring.file = `session-${a.sessionId || a.id}.webm`;\n    }\n  }\n\n  if (a.pageUrl) clean.pageUrl = a.pageUrl;\n  if (a.pageTitle) clean.pageTitle = a.pageTitle;\n  if (a._orphaned) clean.orphaned = true;\n\n  return clean;\n}\n\nfunction buildSummary(annotations) {\n  // Group by page for multi-page clarity\n  const byPage = new Map();\n  for (const a of annotations) {\n    const page = a.pageUrl || 'unknown';\n    if (!byPage.has(page)) byPage.set(page, []);\n    byPage.get(page).push(a);\n  }\n\n  const lines = [];\n\n  for (const [page, anns] of byPage) {\n    if (byPage.size > 1) {\n      lines.push(`\\n--- ${page} ---`);\n    }\n\n    for (const a of anns) {\n      const comment = a.comment ? ` \u2014 \"${a.comment}\"` : '';\n\n      if (a.type === 'highlight') {\n        const where = a.context?.element\n          ? ` in <${a.context.element.tagName?.toLowerCase() || 'element'}>`\n          : '';\n        const path = a.context?.pagePath ? ` (${a.context.pagePath.join(' > ')})` : '';\n        lines.push(`[Highlight] \"${truncate(a.text, 80)}\"${where}${path}${comment}`);\n      } else if (a.type === 'pin') {\n        const desc = a.context?.description || `element #${a.index}`;\n        lines.push(`[Pin #${a.index}] ${desc}${comment}`);\n      } else if (a.type === 'drawing') {\n        const desc = a.context?.description || 'freehand drawing';\n        lines.push(`[Drawing] ${desc}${comment}`);\n      } else if (a.type === 'recording') {\n        const secs = Math.round((a.duration || 0) / 1000);\n        const desc = a.context?.description || 'screen recording';\n        lines.push(`[Recording ${secs}s] ${desc}${comment}`);\n      } else if (a.type === 'session') {\n        const secs = Math.round((a.duration || 0) / 1000);\n        const desc = a.context?.description || 'session recording';\n        lines.push(`[Session ${secs}s] ${desc}${comment}`);\n      }\n    }\n  }\n\n  return lines.join('\\n').trim();\n}\n\nfunction truncate(str, max) {\n  if (!str) return '';\n  return str.length > max ? str.slice(0, max) + '...' : str;\n}\n\nfunction formatDate() {\n  const d = new Date();\n  return `${d.getFullYear()}-${pad(d.getMonth() + 1)}-${pad(d.getDate())}_${pad(d.getHours())}${pad(d.getMinutes())}`;\n}\n\nfunction pad(n) {\n  return n.toString().padStart(2, '0');\n}\n", "export function importFromFile(ctx) {\n  return new Promise((resolve) => {\n    const input = document.createElement('input');\n    input.type = 'file';\n    input.accept = '.json';\n    input.style.display = 'none';\n    document.body.appendChild(input);\n\n    input.addEventListener('change', async () => {\n      const file = input.files[0];\n      if (!file) {\n        input.remove();\n        resolve({ success: false, error: 'No file selected' });\n        return;\n      }\n\n      try {\n        const text = await file.text();\n        const data = JSON.parse(text);\n        const result = importData(ctx, data);\n        resolve(result);\n      } catch (err) {\n        resolve({ success: false, error: err.message });\n      } finally {\n        input.remove();\n      }\n    });\n\n    input.click();\n  });\n}\n\nexport function importData(ctx, data) {\n  if (!data || !data.annotations || !Array.isArray(data.annotations)) {\n    return { success: false, error: 'Invalid annotation data' };\n  }\n\n  const { store, highlightManager, pinManager, drawingManager } = ctx;\n  const results = { imported: 0, orphaned: 0, orphans: [] };\n\n  for (const raw of data.annotations) {\n    // Unpack _anchoring back onto top-level fields for re-anchoring\n    const ann = { ...raw };\n    if (ann._anchoring) {\n      Object.assign(ann, ann._anchoring);\n      delete ann._anchoring;\n    }\n    const annotation = store.add(ann);\n\n    let anchored = false;\n    if (annotation.type === 'highlight') {\n      anchored = highlightManager.applyHighlight(annotation);\n    } else if (annotation.type === 'pin') {\n      anchored = pinManager.applyPin(annotation);\n    } else if (annotation.type === 'drawing') {\n      anchored = drawingManager.applyDrawing(annotation);\n    } else if (annotation.type === 'recording') {\n      // Recordings are always considered anchored (region-based, no DOM target)\n      anchored = true;\n    } else if (annotation.type === 'session') {\n      // Sessions are always anchored (no DOM target)\n      anchored = true;\n    }\n\n    if (anchored) {\n      results.imported++;\n    } else {\n      results.orphaned++;\n      results.orphans.push(annotation.id);\n      store.update(annotation.id, { _orphaned: true });\n    }\n  }\n\n  return { success: true, ...results };\n}\n", "import { buildExportData } from './export.js';\n\nconst TUS_BASE = 'https://share.mk/files/';\n\nasync function tusUpload(bytes, metadata) {\n  const createRes = await fetch(TUS_BASE, {\n    method: 'POST',\n    headers: {\n      'Tus-Resumable': '1.0.0',\n      'Upload-Length': String(bytes.byteLength),\n      'Upload-Metadata': metadata\n        .map(([k, v]) => `${k} ${btoa(v)}`)\n        .join(','),\n    },\n  });\n\n  if (!createRes.ok) throw new Error(`Upload failed: ${createRes.status}`);\n\n  const location = createRes.headers.get('Location');\n  if (!location) throw new Error('No Location header in response');\n\n  const fileUrl = location.startsWith('http')\n    ? location\n    : new URL(location, TUS_BASE).href;\n\n  const patchRes = await fetch(fileUrl, {\n    method: 'PATCH',\n    headers: {\n      'Tus-Resumable': '1.0.0',\n      'Upload-Offset': '0',\n      'Content-Type': 'application/offset+octet-stream',\n    },\n    body: bytes,\n  });\n\n  if (!patchRes.ok) throw new Error(`Patch failed: ${patchRes.status}`);\n\n  return fileUrl;\n}\n\nexport async function shareAnnotations(store, crossPageAnnotations, events) {\n  try {\n    events.emit('share:uploading');\n\n    const data = buildExportData(store, crossPageAnnotations);\n\n    // Collect video blobs from store\n    const blobs = [];\n    for (const ann of store.getAll()) {\n      if ((ann.type === 'recording' || ann.type === 'session') && ann.blob) {\n        const filename = ann.type === 'recording'\n          ? `recording-${ann.id}.webm`\n          : `session-${ann.sessionId || ann.id}.webm`;\n        blobs.push({ id: ann.id, type: ann.type, sessionId: ann.sessionId, blob: ann.blob, filename });\n      }\n    }\n\n    // Upload each video blob and build a map of id/sessionId \u2192 URL\n    const videoUrls = new Map();\n    for (const entry of blobs) {\n      const bytes = new Uint8Array(await entry.blob.arrayBuffer());\n      const url = await tusUpload(bytes, [\n        ['filename', entry.filename],\n        ['content-type', 'video/webm'],\n        ['expires-in', '7d'],\n      ]);\n      videoUrls.set(entry.filename, url);\n    }\n\n    // Patch _anchoring.file fields with share URLs\n    if (videoUrls.size > 0) {\n      for (const ann of data.annotations) {\n        if (ann._anchoring?.file && videoUrls.has(ann._anchoring.file)) {\n          ann._anchoring.file = videoUrls.get(ann._anchoring.file);\n        }\n      }\n    }\n\n    // Upload the final JSON\n    const json = JSON.stringify(data, null, 2);\n    const jsonBytes = new TextEncoder().encode(json);\n    const fileUrl = await tusUpload(jsonBytes, [\n      ['filename', 'annotations.json'],\n      ['content-type', 'application/json'],\n      ['expires-in', '7d'],\n    ]);\n\n    // Copy to clipboard\n    try {\n      await navigator.clipboard.writeText(fileUrl);\n    } catch { /* clipboard may be blocked */ }\n\n    events.emit('share:complete', fileUrl);\n    return fileUrl;\n  } catch (err) {\n    events.emit('share:error', err);\n    return null;\n  }\n}\n", "import { createConfig } from './core/config.js';\nimport { createStore } from './core/store.js';\nimport { createEventBus } from './core/events.js';\nimport { createHighlightManager } from './annotations/highlight.js';\nimport { createPinManager } from './annotations/pin.js';\nimport { createDrawingManager } from './annotations/drawing.js';\nimport { createRecordingManager, canRecord } from './annotations/recording.js';\nimport { createSessionManager } from './annotations/session.js';\nimport { createToolbar } from './ui/toolbar.js';\nimport { createPopoverManager } from './ui/popover.js';\nimport { createEndDialog } from './ui/end-dialog.js';\nimport { createShortcutManager } from './shortcuts.js';\nimport { injectHostStyles, removeHostStyles } from './ui/styles.js';\nimport { exportAnnotations, exportJSON, exportVideo, buildExportData } from './io/export.js';\nimport { importFromFile, importData } from './io/import.js';\nimport { shareAnnotations } from './io/share.js';\n\nconst STORAGE_PREFIX = 'ano:';\n\nlet instance = null;\n\nexport function init(options = {}) {\n  if (instance) {\n    console.warn('[Ano] Already initialized. Call Ano.destroy() first.');\n    return instance.api;\n  }\n\n  const isChildFrame = window !== window.top;\n\n  const config = createConfig(options);\n  const store = createStore();\n  const events = createEventBus();\n\n  const ctx = {\n    config,\n    store,\n    events,\n    mode: 'navigate',\n    sessionState: 'idle', // 'idle' | 'active' | 'ending'\n    currentSessionId: null,\n    toolbar: null,\n    popover: null,\n    endDialog: null,\n    highlightManager: null,\n    pinManager: null,\n    drawingManager: null,\n    recordingManager: null,\n    sessionManager: null,\n    shortcutManager: null,\n    setMode: null,\n  };\n\n  // Create managers\n  ctx.highlightManager = createHighlightManager(ctx);\n  ctx.pinManager = createPinManager(ctx);\n  ctx.drawingManager = createDrawingManager(ctx);\n  if (canRecord) {\n    ctx.recordingManager = createRecordingManager(ctx);\n  }\n  ctx.sessionManager = createSessionManager(ctx);\n\n  // Null stubs for UI components not needed in child frames\n  const nullToolbar = {\n    render: () => {}, renderIdle: () => {}, renderActive: () => {},\n    setActive: () => {}, updateCount: () => {}, getVideoToggleState: () => false,\n    destroy: () => {},\n  };\n  const nullDialog = { show: () => {}, destroy: () => {} };\n\n  // Create UI\n  ctx.toolbar = isChildFrame ? nullToolbar : createToolbar(ctx);\n  ctx.popover = createPopoverManager(ctx);\n  ctx.endDialog = isChildFrame ? nullDialog : createEndDialog(ctx);\n  ctx.shortcutManager = createShortcutManager(ctx);\n\n  // Mode switching \u2014 guarded by session state\n  ctx.setMode = (mode) => {\n    if (!isChildFrame && ctx.sessionState !== 'active' && mode !== 'navigate') return;\n    disableMode(ctx, ctx.mode);\n    ctx.mode = mode;\n    enableMode(ctx, mode);\n    if (!isChildFrame) {\n      ctx.toolbar.setActive(mode);\n      // Broadcast to child frames\n      for (const iframe of document.querySelectorAll('iframe')) {\n        try { iframe.contentWindow?.postMessage({ source: 'ano-parent', type: 'mode:set', payload: mode }, '*'); }\n        catch { /* cross-origin ok */ }\n      }\n    }\n  };\n\n  // Wire events\n  wireEvents(ctx);\n\n  // Inject host-page styles (highlights, pins)\n  injectHostStyles();\n\n  // Initialize drawing canvas (lazy)\n  ctx.drawingManager.init();\n\n  // Render UI\n  ctx.toolbar.render();\n  ctx.popover.init();\n\n  // Enable shortcuts (skip in child frames)\n  if (config.shortcuts && !isChildFrame) {\n    ctx.shortcutManager.enable();\n  }\n\n  // Restore saved annotations and set up persistence (skip in child frames)\n  let persistTimer = null;\n  let unsubPersist = null;\n  if (!isChildFrame) {\n    restoreStore(ctx);\n    unsubPersist = store.on('change', () => {\n      if (persistTimer) clearTimeout(persistTimer);\n      persistTimer = setTimeout(() => persistStore(store), 500);\n    });\n  }\n\n  // Tag annotations with sessionId when added during active session\n  store.on('add', (annotation) => {\n    if (ctx.sessionState === 'active' && ctx.currentSessionId\n        && annotation.type !== 'session' && !annotation.sessionId) {\n      store.update(annotation.id, { sessionId: ctx.currentSessionId });\n    }\n  });\n\n  // Do NOT enable initial mode \u2014 toolbar starts idle, no tools active\n\n  // Setup scroll/resize handlers for pins\n  const repositionHandler = () => ctx.pinManager.repositionAll();\n  window.addEventListener('scroll', repositionHandler, { passive: true });\n  window.addEventListener('resize', repositionHandler, { passive: true });\n\n  // MutationObserver for removed highlights\n  const observer = new MutationObserver((mutations) => {\n    for (const mutation of mutations) {\n      for (const node of mutation.removedNodes) {\n        if (node.classList?.contains('ano-highlight') && node.dataset?.anoId) {\n          const id = node.dataset.anoId;\n          if (store.get(id)) {\n            store.update(id, { _orphaned: true });\n          }\n        }\n      }\n    }\n  });\n  observer.observe(document.body, { childList: true, subtree: true });\n\n  // Child-frame postMessage bridge \u2014 forward annotations to parent, listen for commands\n  if (isChildFrame) {\n    store.on('add', (a) => window.parent.postMessage(\n      { source: 'ano-frame', type: 'annotation:add', payload: cleanForStorage(a), frameUrl: location.href }, '*'));\n    store.on('update', (a) => window.parent.postMessage(\n      { source: 'ano-frame', type: 'annotation:update', payload: cleanForStorage(a), frameUrl: location.href }, '*'));\n    store.on('remove', (id) => window.parent.postMessage(\n      { source: 'ano-frame', type: 'annotation:remove', payload: id, frameUrl: location.href }, '*'));\n\n    function onParentMessage(e) {\n      if (!e.data || e.data.source !== 'ano-parent') return;\n      if (e.data.type === 'mode:set') ctx.setMode(e.data.payload);\n      else if (e.data.type === 'pin:hover') ctx.pinManager.hoverAt(e.data.x, e.data.y);\n      else if (e.data.type === 'pin:click') ctx.pinManager.clickAt(e.data.x, e.data.y);\n      else if (e.data.type === 'destroy') destroyInstance();\n    }\n    window.addEventListener('message', onParentMessage);\n    ctx._cleanupChildMessage = () => window.removeEventListener('message', onParentMessage);\n  }\n\n  // Parent-frame listener \u2014 receive annotations from child frames\n  if (!isChildFrame) {\n    function onFrameMessage(e) {\n      if (!e.data || e.data.source !== 'ano-frame') return;\n      const { type, payload, frameUrl } = e.data;\n      if (type === 'annotation:add') store.add({ ...payload, frameUrl });\n      else if (type === 'annotation:update') store.update(payload.id, { ...payload, frameUrl });\n      else if (type === 'annotation:remove') store.remove(payload);\n    }\n    window.addEventListener('message', onFrameMessage);\n    ctx._cleanupFrameMessage = () => window.removeEventListener('message', onFrameMessage);\n  }\n\n  const api = {\n    getAll: () => store.getAll(),\n    toJSON: () => buildExportData(store, getCrossPageAnnotations()),\n    export: () => exportAnnotations(store, getCrossPageAnnotations()),\n    importFile: () => importFromFile(ctx),\n    import: (data) => importData(ctx, data),\n    setMode: (mode) => ctx.setMode(mode),\n    share: () => events.emit('share'),\n    clear: () => clearInstance(),\n    destroy: () => destroyInstance(),\n    startSession: () => events.emit('session:start'),\n    endSession: () => events.emit('session:end'),\n  };\n\n  instance = {\n    ctx,\n    api,\n    repositionHandler,\n    observer,\n    unsubPersist,\n    persistTimer,\n    isChildFrame,\n  };\n\n  return api;\n}\n\nexport function destroy() {\n  destroyInstance();\n}\n\nfunction clearInstance() {\n  if (!instance) return;\n  const { ctx } = instance;\n  const { store, highlightManager, pinManager, drawingManager, sessionManager } = ctx;\n\n  for (const ann of store.getAll()) {\n    if (ann.type === 'highlight') highlightManager.removeHighlight(ann.id);\n    else if (ann.type === 'pin') pinManager.removePin(ann.id);\n    else if (ann.type === 'drawing') drawingManager.removeDrawing(ann.id);\n    else if (ann.type === 'session') sessionManager.removeSession(ann.id);\n    else if (ann.type === 'recording' && ctx.recordingManager) ctx.recordingManager.removeRecording(ann.id);\n  }\n\n  store.clear();\n  drawingManager.redrawAll();\n  clearStoredAnnotations();\n}\n\nfunction destroyInstance() {\n  if (!instance) return;\n  const { ctx, repositionHandler, observer, unsubPersist, persistTimer, isChildFrame } = instance;\n\n  // Broadcast destroy to all child frames before cleaning up\n  if (!isChildFrame) {\n    for (const iframe of document.querySelectorAll('iframe')) {\n      try { iframe.contentWindow?.postMessage({ source: 'ano-parent', type: 'destroy' }, '*'); }\n      catch {}\n    }\n  }\n\n  if (unsubPersist) unsubPersist();\n  if (persistTimer) clearTimeout(persistTimer);\n\n  observer.disconnect();\n  window.removeEventListener('scroll', repositionHandler);\n  window.removeEventListener('resize', repositionHandler);\n\n  ctx.shortcutManager.destroy();\n  ctx.popover.destroy();\n  ctx.endDialog.destroy();\n  ctx.toolbar.destroy();\n  ctx.highlightManager.destroy();\n  ctx.pinManager.destroy();\n  ctx.drawingManager.destroy();\n  if (ctx.recordingManager) ctx.recordingManager.destroy();\n  ctx.sessionManager.destroy();\n  if (ctx._cleanupHighlightClick) ctx._cleanupHighlightClick();\n  if (ctx._cleanupFrameMessage) ctx._cleanupFrameMessage();\n  if (ctx._cleanupChildMessage) ctx._cleanupChildMessage();\n  if (!isChildFrame) persistStore(ctx.store);\n  ctx.store.clear();\n  ctx.store.destroy();\n  ctx.events.clear();\n  removeHostStyles();\n\n  instance = null;\n}\n\nfunction enableMode(ctx, mode) {\n  switch (mode) {\n    case 'highlight':\n      ctx.highlightManager.enable();\n      break;\n    case 'pin':\n      ctx.pinManager.enable();\n      break;\n    case 'draw':\n      ctx.drawingManager.enable();\n      break;\n    case 'navigate':\n      break;\n  }\n}\n\nfunction disableMode(ctx, mode) {\n  switch (mode) {\n    case 'highlight':\n      ctx.highlightManager.disable();\n      break;\n    case 'pin':\n      ctx.pinManager.disable();\n      break;\n    case 'draw':\n      ctx.drawingManager.disable();\n      break;\n  }\n}\n\n// \u2500\u2500 Helper: wait for recording blob \u2500\u2500\n\nfunction waitForRecordingBlob(recordingManager, timeoutMs = 5000) {\n  return new Promise((resolve) => {\n    const start = Date.now();\n    const check = () => {\n      const blob = recordingManager.getBlob();\n      if (blob) {\n        resolve(blob);\n        return;\n      }\n      if (Date.now() - start >= timeoutMs) {\n        resolve(null);\n        return;\n      }\n      setTimeout(check, 100);\n    };\n    check();\n  });\n}\n\n// \u2500\u2500 localStorage persistence \u2500\u2500\n\nfunction storageKey() {\n  return STORAGE_PREFIX + location.pathname;\n}\n\nfunction persistStore(store) {\n  try {\n    const annotations = store.getAll().map(cleanForStorage);\n    localStorage.setItem(storageKey(), JSON.stringify(annotations));\n  } catch { /* storage full \u2014 ok */ }\n}\n\nfunction cleanForStorage(a) {\n  const c = { ...a };\n  delete c.blob;\n  delete c.blobUrl;\n  delete c._marks;\n  if (!c.pageUrl) c.pageUrl = window.location.href;\n  if (!c.pageTitle) c.pageTitle = document.title;\n  return c;\n}\n\nfunction getCrossPageAnnotations() {\n  const currentKey = storageKey();\n  const results = [];\n  try {\n    for (let i = 0; i < localStorage.length; i++) {\n      const key = localStorage.key(i);\n      if (!key.startsWith(STORAGE_PREFIX) || key === currentKey) continue;\n      const raw = localStorage.getItem(key);\n      if (!raw) continue;\n      const saved = JSON.parse(raw);\n      if (Array.isArray(saved)) {\n        results.push(...saved);\n      }\n    }\n  } catch { /* corrupt \u2014 skip */ }\n  return results;\n}\n\nfunction restoreStore(ctx) {\n  try {\n    const raw = localStorage.getItem(storageKey());\n    if (raw) {\n      const saved = JSON.parse(raw);\n      if (Array.isArray(saved) && saved.length > 0) {\n        importData(ctx, { annotations: saved });\n      }\n    }\n  } catch { /* corrupt \u2014 ignore */ }\n\n  const cross = getCrossPageAnnotations();\n  const global = cross.filter((a) => a.type === 'session' || a.type === 'recording');\n  if (global.length > 0) {\n    const seen = new Set(ctx.store.getAll().map((a) => a.id));\n    const fresh = global.filter((a) => !seen.has(a.id));\n    if (fresh.length > 0) {\n      importData(ctx, { annotations: fresh });\n    }\n  }\n}\n\nfunction clearStoredAnnotations() {\n  try { localStorage.removeItem(storageKey()); } catch { /* ok */ }\n}\n\nfunction wireEvents(ctx) {\n  const { store, events, popover, highlightManager, pinManager, drawingManager } = ctx;\n\n  // \u2500\u2500 Session lifecycle \u2500\u2500\n\n  events.on('session:start', () => {\n    if (ctx.sessionState !== 'idle') return;\n\n    const sessionId = ctx.sessionManager.start();\n    ctx.sessionState = 'active';\n    ctx.currentSessionId = sessionId;\n\n    // Start video recording if toggled on\n    if (ctx.toolbar.getVideoToggleState() && ctx.recordingManager) {\n      ctx.recordingManager.startRecording();\n    }\n\n    ctx.toolbar.renderActive(ctx.sessionManager.getStartTime());\n    ctx.setMode('navigate');\n  });\n\n  events.on('session:end', async () => {\n    if (ctx.sessionState !== 'active') return;\n\n    const wasRecording = ctx.recordingManager?.isRecording();\n\n    // Stop session \u2014 returns data object\n    const sessionData = ctx.sessionManager.stop();\n    if (!sessionData) return;\n\n    // Stop video recording if active\n    if (wasRecording) {\n      ctx.recordingManager.stopRecording();\n    }\n\n    // Disable current annotation mode and broadcast navigate to child frames\n    ctx.setMode('navigate');\n    ctx.sessionState = 'ending';\n    ctx.toolbar.renderIdle();\n\n    // Wait for recording blob if was recording\n    let blob = null;\n    let blobUrl = null;\n    if (wasRecording) {\n      blob = await waitForRecordingBlob(ctx.recordingManager);\n      if (blob) {\n        blobUrl = ctx.recordingManager.getBlobUrl();\n      }\n    }\n\n    // Collect annotations for this session\n    const allAnnotations = store.getAll();\n    const sessionAnnotations = allAnnotations\n      .filter((a) => a.sessionId === sessionData.sessionId && a.type !== 'session');\n    const annotationIds = sessionAnnotations.map((a) => a.id);\n\n    // Build session annotation\n    const sessionAnnotation = {\n      type: 'session',\n      sessionId: sessionData.sessionId,\n      comment: '',\n      duration: sessionData.duration,\n      actions: sessionData.actions,\n      pages: sessionData.pages,\n      context: { description: sessionData.description },\n      annotationIds,\n      hasRecording: !!blob,\n    };\n\n    if (blob) {\n      sessionAnnotation.blob = blob;\n      sessionAnnotation.blobUrl = blobUrl;\n    }\n\n    store.add(sessionAnnotation);\n\n    // Show end dialog with annotation list\n    ctx.endDialog.show({\n      duration: sessionData.duration,\n      actionCount: sessionData.actions.length,\n      pageCount: sessionData.pages.length,\n      annotationCount: annotationIds.length,\n      hasRecording: !!blob,\n      annotations: sessionAnnotations,\n    });\n  });\n\n  events.on('session:dismissed', () => {\n    ctx.sessionState = 'idle';\n    ctx.currentSessionId = null;\n    if (ctx.recordingManager) {\n      ctx.recordingManager.clearBlob();\n    }\n    clearInstance();\n  });\n\n  events.on('session:action', (count) => {\n    ctx.toolbar.updateCount(count);\n  });\n\n  events.on('session:resumed', (data) => {\n    ctx.sessionState = 'active';\n    ctx.currentSessionId = data.sessionId;\n    ctx.toolbar.renderActive(data.startTime);\n  });\n\n  // Late-arriving recording blob \u2014 attach to most recent session\n  events.on('recording:stopped', (data) => {\n    if (ctx.sessionState === 'ending' || ctx.sessionState === 'idle') {\n      // Find most recent session annotation without a blob\n      const sessions = store.getByType('session');\n      for (let i = sessions.length - 1; i >= 0; i--) {\n        const s = sessions[i];\n        if (!s.blob && s.hasRecording === false && data.blob) {\n          store.update(s.id, {\n            blob: data.blob,\n            blobUrl: data.blobUrl,\n            hasRecording: true,\n          });\n          break;\n        }\n      }\n    }\n  });\n\n  // Max duration auto-stop\n  events.on('session:maxDuration', () => {\n    events.emit('session:end');\n  });\n\n  // \u2500\u2500 Annotation events \u2500\u2500\n\n  events.on('highlight:created', (annotation) => {\n    const marks = highlightManager.getMarksForAnnotation(annotation.id);\n    if (marks.length > 0) {\n      const rect = marks[0].getBoundingClientRect();\n      popover.show(annotation.id, rect);\n    }\n  });\n\n  events.on('pin:created', (annotation) => {\n    ctx.setMode('navigate');\n    const el = document.querySelector(`[data-ano-id=\"${annotation.id}\"]`);\n    if (el) {\n      const rect = el.getBoundingClientRect();\n      popover.show(annotation.id, rect);\n    }\n  });\n\n  events.on('drawing:created', (annotation, rawPoints) => {\n    ctx.setMode('navigate');\n    if (rawPoints && rawPoints.length > 0) {\n      const last = rawPoints[rawPoints.length - 1];\n      const rect = {\n        x: last.x, y: last.y,\n        top: last.y, left: last.x,\n        bottom: last.y + 1, right: last.x + 1,\n        width: 1, height: 1,\n      };\n      popover.show(annotation.id, rect);\n    }\n  });\n\n  events.on('pin:click', (annotation) => {\n    const el = document.querySelector(`[data-ano-id=\"${annotation.id}\"]`);\n    if (el) {\n      const rect = el.getBoundingClientRect();\n      popover.show(annotation.id, rect);\n    }\n  });\n\n  events.on('annotation:focus', (annotation) => {\n    if (annotation.frameUrl) return; // can't scroll to annotations in another frame\n    if (annotation.type === 'highlight') {\n      const marks = highlightManager.getMarksForAnnotation(annotation.id);\n      if (marks.length > 0) {\n        marks[0].scrollIntoView({ behavior: 'smooth', block: 'center' });\n        const rect = marks[0].getBoundingClientRect();\n        setTimeout(() => popover.show(annotation.id, rect), 300);\n      }\n    } else if (annotation.type === 'pin') {\n      pinManager.scrollToPin(annotation.id);\n      setTimeout(() => {\n        const el = document.querySelector(`[data-ano-id=\"${annotation.id}\"]`);\n        if (el) {\n          const rect = el.getBoundingClientRect();\n          popover.show(annotation.id, rect);\n        }\n      }, 300);\n    }\n  });\n\n  events.on('annotation:delete', (id) => {\n    const annotation = store.get(id);\n    if (!annotation) return;\n\n    if (annotation.type === 'highlight') {\n      highlightManager.removeHighlight(id);\n    } else if (annotation.type === 'pin') {\n      pinManager.removePin(id);\n    } else if (annotation.type === 'drawing') {\n      drawingManager.removeDrawing(id);\n    } else if (annotation.type === 'recording' && ctx.recordingManager) {\n      ctx.recordingManager.removeRecording(id);\n    } else if (annotation.type === 'session') {\n      ctx.sessionManager.removeSession(id);\n    }\n\n    store.remove(id);\n  });\n\n  // Export\n  events.on('export', () => {\n    exportAnnotations(store, getCrossPageAnnotations());\n  });\n\n  events.on('export:json', () => {\n    exportJSON(store, getCrossPageAnnotations());\n  });\n\n  events.on('export:video', () => {\n    exportVideo(store);\n  });\n\n  // Import\n  events.on('import', () => {\n    importFromFile(ctx);\n  });\n\n  // Share\n  events.on('share', () => {\n    shareAnnotations(store, getCrossPageAnnotations(), events);\n  });\n\n  // Click on highlight marks \u2192 show popover\n  function onHighlightClick(e) {\n    const mark = e.target.closest?.('.ano-highlight');\n    if (mark && mark.dataset.anoId) {\n      e.stopPropagation();\n      const rect = mark.getBoundingClientRect();\n      popover.show(mark.dataset.anoId, rect);\n      return;\n    }\n\n    // Click on drawing strokes \u2192 show popover\n    if (ctx.mode === 'navigate') {\n      const drawing = drawingManager.hitTest(e.clientX, e.clientY);\n      if (drawing) {\n        e.stopPropagation();\n        const rect = {\n          x: e.clientX, y: e.clientY,\n          top: e.clientY, left: e.clientX,\n          bottom: e.clientY + 1, right: e.clientX + 1,\n          width: 1, height: 1,\n        };\n        popover.show(drawing.id, rect);\n      }\n    }\n  }\n  document.addEventListener('click', onHighlightClick, true);\n  ctx._cleanupHighlightClick = () => {\n    document.removeEventListener('click', onHighlightClick, true);\n  };\n}\n"],
  "mappings": "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A;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAgDf,MAAM,eAAe;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA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",
  "names": ["destroy", "exportJSON", "init", "getAll", "clear", "el", "truncate", "el", "destroy", "isAnoElement", "truncate", "el", "destroy", "init", "el", "truncate", "pad", "destroy", "destroy", "nanoid", "el", "text", "isAnoElement", "destroy", "destroy", "init", "destroy", "truncate", "destroy", "isAnoElement", "el", "destroy", "truncate", "location", "el", "init", "destroy", "exportJSON"]
}
